<html>
<head>
<title>프로듀서의 탈출 스토리</title>
</head>
<body>
<div id="log"></div>
<script>

function logMessage(msg, color) {
  if (!color) { color = 'black'; }
  var div = document.createElement('div');
  div.innerHTML = msg;
  div.style.color = color;
  document.getElementById('log').appendChild(div);
}

var gameover = false;
var battle = false;
function Character(name, hp, att) {
  this.name = name;
  this.hp = hp;
  this.att = att;
}
Character.prototype.attacked = function (damage) {
  this.hp -= damage;
  logMessage(this.name + '의 체력이 ' + this.hp + '가 되었습니다');
  if (this.hp <= 0) {
    battle = false;
  }
};
Character.prototype.attack = function (target) {
  logMessage(this.name + '가 ' + target.name + '을 공격합니다');
  target.attacked(this.att);
};

function Hero(name, hp, att, lev, xp) {
  Character.apply(this, arguments);
  this.lev = lev || 1;
  this.xp = xp || 0;
}
Hero.prototype = Object.create(Character.prototype);
Hero.prototype.constructor = Hero;
Hero.prototype.attacked = function(damage) {
  this.hp -= damage;
  logMessage(this.name + '의 체력이 ' + this.hp + '남았습니다');
  if (this.hp <= 0) {
    logMessage('잡혔습니다. 레벨' + this.lev + '에서 탈출이 끝납니다. F5를 누르면 다시 시도할 수 있습니다', 'red');
    battle = false;
    gameover = true;
  }
};
Hero.prototype.attack = function (target) {
  logMessage(this.name + '가 ' + target.name + '을 공격합니다');
  target.attacked(this.att);
  if (target.hp <= 0) {
    this.gainXp(target);
  }
};
Hero.prototype.gainXp = function(target) {
  logMessage('전투에서 승리하여 ' + target.xp + '의 경험치를 얻습니다', 'blue');
  this.xp += target.xp;
  if (this.xp > 100 + 10 * this.lev) {
    this.lev++;
    logMessage('레벨업! ' + this.lev + ' 레벨이 되었습니다', 'blue');
    this.hp = 20 + this.hp + this.lev * 3;
    this.xp -= 10 * this.lev + 100;
  }
};

function Monster(name, hp, att, lev, xp) {
  Character.apply(this, arguments);
  this.lev = lev || 1;
  this.xp = xp || 10;
}
Monster.prototype = Object.create(Character.prototype);
Monster.prototype.constructor = Monster;

function makeMonster() {
  var monsterArray = [
    ['히어로 레드', 25, 5, 1, 45],
    ['비둘기 뱀파이어', 150, 9, 2, 60],
    ['무시무시한 푸른 광견', 50, 8, 2, 60],
    ['꿀밤마려운 여동생', 50, 8, 2, 60],
    ['사문서조작현행범', 10, 2, 1, 20],
    ['데비타로좋아', 30, 8, 2, 40],
    ['침묵하면초미인', 150, 8, 2, 60],
    ['보라색솜사탕', 50, 8, 2, 60],
    ['나이많은미쨩', 130, 8, 2, 100],
    ['정글짐옆포카리스웨트', 130, 9, 3, 105],
    ['허그좋아하는혼혈여고생', 120, 11, 4, 130],
    ['삼일굶은초코아이돌', 35, 4, 1, 165],
    ['아하(물리)', 90, 12, 4, 210],
    ['보이시한기계치', 50, 8, 2, 60],
    ['얀데레각성한순정녀', 90, 13, 5, 230],
    ['규동좋아하는서큐버스', 150, 8, 2, 190],
    ['멘탈나간인싸여고생', 170, 8, 2, 180],
    ['사랑을자각한중학생', 30, 17, 2, 350],
    ['갸루여고생', 50, 8, 2, 60],
    ['너는여기서나랑죽는거야', 200, 9, 2, 180],
    ['아직도내맘을몰라?', 120, 14, 4, 170],
    ['댕댕이시바견', 120, 11, 4, 120],
    ['흑막재벌녀', 260, 12, 4, 190],
    ['빨강머리집착녀', 150, 13, 4, 180],
    ['형언할수없는기리릭', 500, 25, 6, 250],
    ['월급 못받은 알바', 300, 23, 6, 210]
  ];
  var monster = monsterArray[Math.floor(Math.random() * 26)];
  return new Monster(monster[0], monster[1], monster[2], monster[3], monster[4],monster[5], monster[6], monster[7], monster[8], monster[9],monster[10], monster[11], monster[12], monster[13], monster[14],monster[15], monster[16], monster[17], monster[18], monster[19],monster[20], monster[21], monster[22], monster[23], monster[24],monster[25], monster[26]);
}

var war = 1;

var hero = new Hero('프로듀서', 55, 36);
logMessage(hero.name + '가 탈출을 시작합니다. 어디까지 탈출 할 수 있을까요?');
while (!gameover) {
     if (war > 15) {
	logMessage('축하합니다. 당신은 탈출에 성공하였습니다.', 'red');
      break;
   }
	else {
  var monster = makeMonster();
  logMessage(monster.name + '을 마주쳤습니다. 전투가 시작됩니다', 'green');
  battle = true;   while(battle) {
    hero.attack(monster);
    if (monster.hp > 0) {
      monster.attack(hero);
      continue;
    }
  }
  }
   war = war + 1;
}

</script>
</body>
</html>