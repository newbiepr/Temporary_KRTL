// ==UserScript==
// @name         샤니마스 한글 패치 임시
// @namespace    https://github.com/newbiepr/shinycolors-trans-kr
// @version      1.2.2
// @description  샤니마스 임시 한글 패치 스크립트
// @icon         https://shinycolors.enza.fun/icon_192x192.png
// @author       Source : biuuu
// @match        https://shinycolors.enza.fun/*
// @run-at       document-start
// @grant        GM_xmlhttpRequest
// @grant        GM_registerMenuCommand
// @grant        GM_unregisterMenuCommand
// @connect      api.interpreter.caiyunai.com
// @connect      translate.google.cn
// @connect      fanyi.baidu.com
// @updateURL    https://newbiepr.github.io/Temporary_KRTL/ShinyColors.user.js
// ==/UserScript==
!function(){"use strict";var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e,t,r){return e(r={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&r.path)}},r.exports),r.exports}var r="object"==typeof e&&e&&e.Object===Object&&e,n="object"==typeof self&&self&&self.Object===Object&&self,o=r||n||Function("return this")(),a=o.Symbol,s=Object.prototype,i=s.hasOwnProperty,c=s.toString,l=a?a.toStringTag:void 0;var u=function(e){var t=i.call(e,l),r=e[l];try{e[l]=void 0;var n=!0}catch(e){}var o=c.call(e);return n&&(t?e[l]=r:delete e[l]),o},d=Object.prototype.toString;var f=function(e){return d.call(e)},p=a?a.toStringTag:void 0;var h=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":p&&p in Object(e)?u(e):f(e)},m=Array.isArray;var y=function(e){return null!=e&&"object"==typeof e};var v=function(e){return"string"==typeof e||!m(e)&&y(e)&&"[object String]"==h(e)};var g=function(e){return!0===e||!1===e||y(e)&&"[object Boolean]"==h(e)};var w=function(e,t){return function(r){return e(t(r))}},b=w(Object.getPrototypeOf,Object),_=Function.prototype,E=Object.prototype,k=_.toString,S=E.hasOwnProperty,j=k.call(Object);var x=function(e){if(!y(e)||"[object Object]"!=h(e))return!1;var t=b(e);if(null===t)return!0;var r=S.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&k.call(r)==j};const A={origin:"https://newbiepr.github.io/Temporary_KRTL",hash:"",localHash:"",version:"1.2.2",story:"normal",timeout:30,font1:"yuanti",font2:"heiti",auto:"off",bgm:"off",dev:!1},I=Object.assign({},A),C=["yuanti","heiti","yuanti2"],R={HEITI_JA:"UDKakugo_SmallPr6-B",HEITI_TRANS:"sczh-heiti,UDKakugo_SmallPr6-B",YUAN_JA:"HummingStd-E",YUAN_TRANS:"sczh-yuanti,HummingStd-E"},M=["origin","font1","font2","timeout","story","auto","bgm","dev"],O=M,T=()=>{R.HEITI_TRANS=`${C.includes(A.font2)?"sczh-":""}${A.font2},${R.HEITI_JA}`,R.YUAN_TRANS=`${C.includes(A.font1)?"sczh-":""}${A.font1},${R.YUAN_JA}`},P=()=>{const e={};O.forEach(t=>{A[t]!==I[t]&&(e[t]=A[t])}),T(),localStorage.setItem("sczh:setting",JSON.stringify(e))},$=()=>{let e=location.hash;e=e.slice(1).replace(/\?tdsourcetag=s_pc(tim|qq)_aiomsg/,""),e.split(";").forEach(e=>{let t=e.split("="),r=decodeURIComponent(t[0].trim()),n=t[1]?decodeURIComponent(t[1].trim()):"";r&&O.includes(r)&&(A[r]=n||I[r],P())})},D={story:{normal:"커뮤 추출 열기",edit:"커뮤 추출 닫기",id:0,callback:()=>{if("normal"===A.story)A.story="edit";else{const e=document.getElementById("btn-close-sczh");e?e.click():A.story="normal"}}},bgm:{on:"백그라운드 BGM 끄기",off:"백그라운드 BGM 켜기",id:0,callback:()=>{A.bgm="off"!==A.bgm?"off":"on"}},update:{id:0,title:"업데이트",callback:()=>{window.open(A.origin+"/ShinyColors.user.js")}}},z=e=>{const t=A[e],r=D[e];let n="";if(g(t)){let e=t?1:0;n=r.titles[e]}else n=r.title||r[t];const o=r.id;o&&window.GM_unregisterMenuCommand(o),r.id=window.GM_registerMenuCommand(n,()=>{(0,r.callback)(),P(),F()})},F=()=>{if(!window.GM_registerMenuCommand||!window.GM_unregisterMenuCommand)return;["update","bgm","story"].forEach(e=>{z(e)})};(()=>{const e=localStorage.getItem("sczh:setting");let t=JSON.parse(e);x(t)||(t={});const{origin:r}=t;/^https?:\/\//.test(r)&&(A.origin=r.trim()),O.forEach(e=>{let r=t[e];v(r)&&(r=r.trim()),(g(r)||r)&&(A[e]=r)}),T()})(),$(),F(),window.addEventListener("hashchange",$);const N=e=>"​"+e,L=e=>{if(!e)return"";return e.replace(/[\u0020]+$/g,"").replace(/^[\u0020]+/g,"")},U=(e,t=!1)=>{let r=L(e).replace(/(\\r)?\\n/g,"\n").replace(/\\r/g,"\n");return t?r:r.replace(/\n{2,}/g,"\n")},B=e=>L(e).replace(/\r/g,"\n").replace(/\n{2,}/g,"\n"),H=e=>e.replace(/\?/g,"\\?").replace(/\./g,"\\.").replace(/\*/g,"\\*").replace(/\+/g,"\\+").replace(/\(/g,"\\(").replace(/\)/g,"\\)"),J=(...e)=>{A.dev&&console.info(...e)},W=e=>v(e)?e.replace(/\r?\n/g,"\\n").replace(/\r/g,"\\n"):e,q=(e="0.0.0",t="0.0.0")=>{let r=!1;const n=e.split(".").map(e=>parseInt(e,10)),o=t.split(".").map(e=>parseInt(e,10));for(let e=0;e<n.length;e++){(n[e]||0)>(o[e]||0)&&(r=!0)}return r},G=["プロデューサー","審査員"],Y=(e,t)=>{if(e.speaker){const r=L(e.speaker);G.includes(r)&&t.has(r)&&(e.speaker=N(t.get(r)))}},K=()=>{const e=new Map;return t=>{if(t&&!/^0+$/.test(t)&&"select"!==t){if(e.has(t)){const r=e.get(t);return e.set(t,r+1),`${t}-${r}`}e.set(t,0)}return t}},{origin:Q,version:V}=A,Z=async()=>{const e=Math.floor(Date.now()/1e3/60/60/6),t=await fetch(`${Q}/manifest.json?t=${e}`);if(t.ok){const e=await t.json();return e.time=Date.now(),localStorage.setItem("sczh:manifest",JSON.stringify(e)),e}throw new Error(`${t.status} ${t.url}`)},X=new Promise((e,t)=>{(async()=>{let e;try{let t=localStorage.getItem("sczh:manifest");t&&(e=JSON.parse(t)),Date.now()-e.time>60*A.cacheTime*1e3&&(e=!1)}catch(e){}return e?q(V,e.version)?e=await Z():setTimeout(Z,5e3):e=await Z(),e})().then(t=>{A.newVersion=t.version,A.hashes=t.hashes,e(t)}).catch(t)}),ee=async(e,t)=>{if(!t){const{hashes:r}=await X;t=r[e.replace(/^\/(data\/)?/,"")]}return await(async e=>new Promise((t,r)=>{let n=setTimeout(()=>{r(`불러오기${e}시간초과`)},1e3*A.timeout);fetch(`${Q}${e}`).then(e=>{if(clearTimeout(n),!e.ok)return r(`${e.status} ${e.url}`),"";const t=e.headers.get("content-type");return(null==t?void 0:t.includes("json"))?e.json():e.text()}).then(t).catch(r)}))(`${e}${t?"?v="+t:""}`)};var te=t((function(e,t){Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),e.exports=function(){var e,t,r="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:{},n=!r.document&&!!r.postMessage,o=n&&/(\?|&)papaworker(=|&|$)/.test(r.location.search),a=!1,s={},i=0,c={parse:function(t,n){var o=(n=n||{}).dynamicTyping||!1;if(k(o)&&(n.dynamicTypingFunction=o,o={}),n.dynamicTyping=o,n.transform=!!k(n.transform)&&n.transform,n.worker&&c.WORKERS_SUPPORTED){var l=function(){if(!c.WORKERS_SUPPORTED)return!1;if(!a&&null===c.SCRIPT_PATH)throw new Error("Script path cannot be determined automatically when Papa Parse is loaded asynchronously. You need to set Papa.SCRIPT_PATH manually.");var t=c.SCRIPT_PATH||e;t+=(-1!==t.indexOf("?")?"&":"?")+"papaworker";var n=new r.Worker(t);return n.onmessage=g,n.id=i++,s[n.id]=n}();return l.userStep=n.step,l.userChunk=n.chunk,l.userComplete=n.complete,l.userError=n.error,n.step=k(n.step),n.chunk=k(n.chunk),n.complete=k(n.complete),n.error=k(n.error),delete n.worker,void l.postMessage({input:t,config:n,workerId:l.id})}var u=null;return"string"==typeof t?u=n.download?new d(n):new p(n):!0===t.readable&&k(t.read)&&k(t.on)?u=new h(n):(r.File&&t instanceof File||t instanceof Object)&&(u=new f(n)),u.stream(t)},unparse:function(e,t){var r=!1,n=!0,o=",",a="\r\n",s='"',i=!1;"object"==typeof t&&("string"!=typeof t.delimiter||c.BAD_DELIMITERS.filter((function(e){return-1!==t.delimiter.indexOf(e)})).length||(o=t.delimiter),("boolean"==typeof t.quotes||Array.isArray(t.quotes))&&(r=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(i=t.skipEmptyLines),"string"==typeof t.newline&&(a=t.newline),"string"==typeof t.quoteChar&&(s=t.quoteChar),"boolean"==typeof t.header&&(n=t.header));var l=new RegExp(y(s),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return d(null,e,i);if("object"==typeof e[0])return d(u(e[0]),e,i)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:u(e.data[0])),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),d(e.fields||[],e.data||[],i);throw"exception: Unable to serialize unrecognized input";function u(e){if("object"!=typeof e)return[];var t=[];for(var r in e)t.push(r);return t}function d(e,t,r){var s="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var i=Array.isArray(e)&&0<e.length,c=!Array.isArray(t[0]);if(i&&n){for(var l=0;l<e.length;l++)0<l&&(s+=o),s+=f(e[l],l);0<t.length&&(s+=a)}for(var u=0;u<t.length;u++){var d=i?e.length:t[u].length,p=!1,h=i?0===Object.keys(t[u]).length:0===t[u].length;if(r&&!i&&(p="greedy"===r?""===t[u].join("").trim():1===t[u].length&&0===t[u][0].length),"greedy"===r&&i){for(var m=[],y=0;y<d;y++){var v=c?e[y]:y;m.push(t[u][v])}p=""===m.join("").trim()}if(!p){for(var g=0;g<d;g++){0<g&&!h&&(s+=o);var w=i&&c?e[g]:g;s+=f(t[u][w],g)}u<t.length-1&&(!r||0<d&&!h)&&(s+=a)}}return s}function f(e,t){return null==e?"":e.constructor===Date?JSON.stringify(e).slice(1,25):(e=e.toString().replace(l,s+s),"boolean"==typeof r&&r||Array.isArray(r)&&r[t]||function(e,t){for(var r=0;r<t.length;r++)if(-1<e.indexOf(t[r]))return!0;return!1}(e,c.BAD_DELIMITERS)||-1<e.indexOf(o)||" "===e.charAt(0)||" "===e.charAt(e.length-1)?s+e+s:e)}}};if(c.RECORD_SEP=String.fromCharCode(30),c.UNIT_SEP=String.fromCharCode(31),c.BYTE_ORDER_MARK="\ufeff",c.BAD_DELIMITERS=["\r","\n",'"',c.BYTE_ORDER_MARK],c.WORKERS_SUPPORTED=!n&&!!r.Worker,c.SCRIPT_PATH=null,c.NODE_STREAM_INPUT=1,c.LocalChunkSize=10485760,c.RemoteChunkSize=5242880,c.DefaultDelimiter=",",c.Parser=v,c.ParserHandle=m,c.NetworkStreamer=d,c.FileStreamer=f,c.StringStreamer=p,c.ReadableStreamStreamer=h,r.jQuery){var l=r.jQuery;l.fn.parse=function(e){var t=e.config||{},n=[];return this.each((function(e){if("INPUT"!==l(this).prop("tagName").toUpperCase()||"file"!==l(this).attr("type").toLowerCase()||!r.FileReader||!this.files||0===this.files.length)return!0;for(var o=0;o<this.files.length;o++)n.push({file:this.files[o],inputElem:this,instanceConfig:l.extend({},t)})})),o(),this;function o(){if(0!==n.length){var t,r,o,s=n[0];if(k(e.before)){var i=e.before(s.file,s.inputElem);if("object"==typeof i){if("abort"===i.action)return t=s.file,r=s.inputElem,o=i.reason,void(k(e.error)&&e.error({name:"AbortError"},t,r,o));if("skip"===i.action)return void a();"object"==typeof i.config&&(s.instanceConfig=l.extend(s.instanceConfig,i.config))}else if("skip"===i)return void a()}var u=s.instanceConfig.complete;s.instanceConfig.complete=function(e){k(u)&&u(e,s.file,s.inputElem),a()},c.parse(s.file,s.instanceConfig)}else k(e.complete)&&e.complete()}function a(){n.splice(0,1),o()}}}function u(e){this._handle=null,this._finished=!1,this._completed=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},function(e){var t=_(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new m(t),(this._handle.streamer=this)._config=t}.call(this,e),this.parseChunk=function(e,t){if(this.isFirstChunk&&k(this._config.beforeFirstChunk)){var n=this._config.beforeFirstChunk(e);void 0!==n&&(e=n)}this.isFirstChunk=!1;var a=this._partialLine+e;this._partialLine="";var s=this._handle.parse(a,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var i=s.meta.cursor;this._finished||(this._partialLine=a.substring(i-this._baseIndex),this._baseIndex=i),s&&s.data&&(this._rowCount+=s.data.length);var l=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(o)r.postMessage({results:s,workerId:c.WORKER_ID,finished:l});else if(k(this._config.chunk)&&!t){if(this._config.chunk(s,this._handle),this._handle.paused()||this._handle.aborted())return;s=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(s.data),this._completeResults.errors=this._completeResults.errors.concat(s.errors),this._completeResults.meta=s.meta),this._completed||!l||!k(this._config.complete)||s&&s.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),l||s&&s.meta.paused||this._nextChunk(),s}},this._sendError=function(e){k(this._config.error)?this._config.error(e):o&&this._config.error&&r.postMessage({workerId:c.WORKER_ID,error:e,finished:!1})}}function d(e){var t;(e=e||{}).chunkSize||(e.chunkSize=c.RemoteChunkSize),u.call(this,e),this._nextChunk=n?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),n||(t.onload=E(this._chunkLoaded,this),t.onerror=E(this._chunkError,this)),t.open("GET",this._input,!n),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e)t.setRequestHeader(r,e[r])}if(this._config.chunkSize){var o=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+o),t.setRequestHeader("If-None-Match","webkit-no-cache")}try{t.send()}catch(e){this._chunkError(e.message)}n&&0===t.status?this._chunkError():this._start+=this._config.chunkSize}},this._chunkLoaded=function(){4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._finished=!this._config.chunkSize||this._start>function(e){var t=e.getResponseHeader("Content-Range");return null===t?-1:parseInt(t.substr(t.lastIndexOf("/")+1))}(t),this.parseChunk(t.responseText)))},this._chunkError=function(e){var r=t.statusText||e;this._sendError(new Error(r))}}function f(e){var t,r;(e=e||{}).chunkSize||(e.chunkSize=c.LocalChunkSize),u.call(this,e);var n="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,r=e.slice||e.webkitSlice||e.mozSlice,n?((t=new FileReader).onload=E(this._chunkLoaded,this),t.onerror=E(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var o=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,o)}var a=t.readAsText(e,this._config.encoding);n||this._chunkLoaded({target:{result:a}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function p(e){var t;u.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e=this._config.chunkSize,r=e?t.substr(0,e):t;return t=e?t.substr(e):"",this._finished=!t,this.parseChunk(r)}}}function h(e){u.call(this,e=e||{});var t=[],r=!0,n=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):r=!0},this._streamData=E((function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),r&&(r=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}}),this),this._streamError=E((function(e){this._streamCleanUp(),this._sendError(e)}),this),this._streamEnd=E((function(){this._streamCleanUp(),n=!0,this._streamData("")}),this),this._streamCleanUp=E((function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)}),this)}function m(e){var t,r,n,o=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,a=/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/,s=this,i=0,l=0,u=!1,d=!1,f=[],p={data:[],errors:[],meta:{}};if(k(e.step)){var h=e.step;e.step=function(t){if(p=t,w())g();else{if(g(),0===p.data.length)return;i+=t.data.length,e.preview&&i>e.preview?r.abort():h(p,s)}}}function m(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function g(){if(p&&n&&(E("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+c.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines)for(var t=0;t<p.data.length;t++)m(p.data[t])&&p.data.splice(t--,1);return w()&&function(){if(p){for(var t=0;w()&&t<p.data.length;t++)for(var r=0;r<p.data[t].length;r++){var n=p.data[t][r];e.trimHeaders&&(n=n.trim()),f.push(n)}p.data.splice(0,1)}}(),function(){if(!p||!e.header&&!e.dynamicTyping&&!e.transform)return p;for(var t=0;t<p.data.length;t++){var r,n=e.header?{}:[];for(r=0;r<p.data[t].length;r++){var o=r,a=p.data[t][r];e.header&&(o=r>=f.length?"__parsed_extra":f[r]),e.transform&&(a=e.transform(a,o)),a=b(o,a),"__parsed_extra"===o?(n[o]=n[o]||[],n[o].push(a)):n[o]=a}p.data[t]=n,e.header&&(r>f.length?E("FieldMismatch","TooManyFields","Too many fields: expected "+f.length+" fields but parsed "+r,l+t):r<f.length&&E("FieldMismatch","TooFewFields","Too few fields: expected "+f.length+" fields but parsed "+r,l+t))}return e.header&&p.meta&&(p.meta.fields=f),l+=p.data.length,p}()}function w(){return e.header&&0===f.length}function b(t,r){return n=t,e.dynamicTypingFunction&&void 0===e.dynamicTyping[n]&&(e.dynamicTyping[n]=e.dynamicTypingFunction(n)),!0===(e.dynamicTyping[n]||e.dynamicTyping)?"true"===r||"TRUE"===r||"false"!==r&&"FALSE"!==r&&(o.test(r)?parseFloat(r):a.test(r)?new Date(r):""===r?null:r):r;var n}function E(e,t,r,n){p.errors.push({type:e,code:t,message:r,row:n})}this.parse=function(o,a,s){var i=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substr(0,1048576);var r=new RegExp(y(t)+"([^]*?)"+y(t),"gm"),n=(e=e.replace(r,"")).split("\r"),o=e.split("\n"),a=1<o.length&&o[0].length<n[0].length;if(1===n.length||a)return"\n";for(var s=0,i=0;i<n.length;i++)"\n"===n[i][0]&&s++;return s>=n.length/2?"\r\n":"\r"}(o,i)),n=!1,e.delimiter)k(e.delimiter)&&(e.delimiter=e.delimiter(o),p.meta.delimiter=e.delimiter);else{var l=function(t,r,n,o){for(var a,s,i,l=[",","\t","|",";",c.RECORD_SEP,c.UNIT_SEP],u=0;u<l.length;u++){var d=l[u],f=0,p=0,h=0;i=void 0;for(var y=new v({comments:o,delimiter:d,newline:r,preview:10}).parse(t),g=0;g<y.data.length;g++)if(n&&m(y.data[g]))h++;else{var w=y.data[g].length;p+=w,void 0!==i?1<w&&(f+=Math.abs(w-i),i=w):i=0}0<y.data.length&&(p/=y.data.length-h),(void 0===s||s<f)&&1.99<p&&(s=f,a=d)}return{successful:!!(e.delimiter=a),bestDelimiter:a}}(o,e.newline,e.skipEmptyLines,e.comments);l.successful?e.delimiter=l.bestDelimiter:(n=!0,e.delimiter=c.DefaultDelimiter),p.meta.delimiter=e.delimiter}var d=_(e);return e.preview&&e.header&&d.preview++,t=o,r=new v(d),p=r.parse(t,a,s),g(),u?{meta:{paused:!0}}:p||{meta:{paused:!1}}},this.paused=function(){return u},this.pause=function(){u=!0,r.abort(),t=t.substr(r.getCharIndex())},this.resume=function(){u=!1,s.streamer.parseChunk(t,!0)},this.aborted=function(){return d},this.abort=function(){d=!0,r.abort(),p.meta.aborted=!0,k(e.complete)&&e.complete(p),t=""}}function y(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function v(e){var t,r=(e=e||{}).delimiter,n=e.newline,o=e.comments,a=e.step,s=e.preview,i=e.fastMode,l=t=void 0===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(l=e.escapeChar),("string"!=typeof r||-1<c.BAD_DELIMITERS.indexOf(r))&&(r=","),o===r)throw"Comment character same as delimiter";!0===o?o="#":("string"!=typeof o||-1<c.BAD_DELIMITERS.indexOf(o))&&(o=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var u=0,d=!1;this.parse=function(e,c,f){if("string"!=typeof e)throw"Input must be a string";var p=e.length,h=r.length,m=n.length,v=o.length,g=k(a),w=[],b=[],_=[],E=u=0;if(!e)return D();if(i||!1!==i&&-1===e.indexOf(t)){for(var S=e.split(n),j=0;j<S.length;j++){if(_=S[j],u+=_.length,j!==S.length-1)u+=n.length;else if(f)return D();if(!o||_.substr(0,v)!==o){if(g){if(w=[],O(_.split(r)),z(),d)return D()}else O(_.split(r));if(s&&s<=j)return w=w.slice(0,s),D(!0)}}return D()}for(var x,A=e.indexOf(r,u),I=e.indexOf(n,u),C=new RegExp(y(l)+y(t),"g");;)if(e[u]!==t)if(o&&0===_.length&&e.substr(u,v)===o){if(-1===I)return D();u=I+m,I=e.indexOf(n,u),A=e.indexOf(r,u)}else if(-1!==A&&(A<I||-1===I))_.push(e.substring(u,A)),u=A+h,A=e.indexOf(r,u);else{if(-1===I)break;if(_.push(e.substring(u,I)),$(I+m),g&&(z(),d))return D();if(s&&w.length>=s)return D(!0)}else for(x=u,u++;;){if(-1===(x=e.indexOf(t,x+1)))return f||b.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:w.length,index:u}),P();if(x===p-1)return P(e.substring(u,x).replace(C,t));if(t!==l||e[x+1]!==l){if(t===l||0===x||e[x-1]!==l){var R=T(-1===I?A:Math.min(A,I));if(e[x+1+R]===r){_.push(e.substring(u,x).replace(C,t)),u=x+1+R+h,A=e.indexOf(r,u),I=e.indexOf(n,u);break}var M=T(I);if(e.substr(x+1+M,m)===n){if(_.push(e.substring(u,x).replace(C,t)),$(x+1+M+m),A=e.indexOf(r,u),g&&(z(),d))return D();if(s&&w.length>=s)return D(!0);break}b.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:w.length,index:u}),x++}}else x++}return P();function O(e){w.push(e),E=u}function T(t){var r=0;if(-1!==t){var n=e.substring(x+1,t);n&&""===n.trim()&&(r=n.length)}return r}function P(t){return f||(void 0===t&&(t=e.substr(u)),_.push(t),u=p,O(_),g&&z()),D()}function $(t){u=t,O(_),_=[],I=e.indexOf(n,u)}function D(e){return{data:w,errors:b,meta:{delimiter:r,linebreak:n,aborted:d,truncated:!!e,cursor:E+(c||0)}}}function z(){a(D()),w=[],b=[]}},this.abort=function(){d=!0},this.getCharIndex=function(){return u}}function g(e){var t=e.data,r=s[t.workerId],n=!1;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var o={abort:function(){n=!0,w(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:b,resume:b};if(k(r.userStep)){for(var a=0;a<t.results.data.length&&(r.userStep({data:[t.results.data[a]],errors:t.results.errors,meta:t.results.meta},o),!n);a++);delete t.results}else k(r.userChunk)&&(r.userChunk(t.results,o,t.file),delete t.results)}t.finished&&!n&&w(t.workerId,t.results)}function w(e,t){var r=s[e];k(r.userComplete)&&r.userComplete(t),r.terminate(),delete s[e]}function b(){throw"Not implemented."}function _(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=_(e[r]);return t}function E(e,t){return function(){e.apply(t,arguments)}}function k(e){return"function"==typeof e}return o?r.onmessage=function(e){var t=e.data;if(void 0===c.WORKER_ID&&t&&(c.WORKER_ID=t.workerId),"string"==typeof t.input)r.postMessage({workerId:c.WORKER_ID,results:c.parse(t.input,t.config),finished:!0});else if(r.File&&t.input instanceof File||t.input instanceof Object){var n=c.parse(t.input,t.config);n&&r.postMessage({workerId:c.WORKER_ID,results:n,finished:!0})}}:c.WORKERS_SUPPORTED&&(t=document.getElementsByTagName("script"),e=t.length?t[t.length-1].src:"",document.body?document.addEventListener("DOMContentLoaded",(function(){a=!0}),!0):a=!0),(d.prototype=Object.create(u.prototype)).constructor=d,(f.prototype=Object.create(u.prototype)).constructor=f,(p.prototype=Object.create(p.prototype)).constructor=p,(h.prototype=Object.create(u.prototype)).constructor=h,c}()}));const re=e=>{try{return te.parse(e.replace(/^\ufeff/,""),{header:!0}).data}catch(e){return console.log(e),{}}};let ne=null;const oe=async e=>{if(!ne)try{const e=localStorage.getItem("sczh:data");if(!e)return!1;ne=JSON.parse(e)}catch(e){return console.error(e),!1}if(q(A.version,ne.version))return ne=null,localStorage.removeItem("sczh:data"),!1;let t=e;/(\.csv|\.json)/.test(e)||(t=e+".csv");const{hashes:r}=await X,n=r[t],o=ne.hashes[t];return o&&o===n?ne[e]:(ne.hashes[t]=n,!1)},ae=(e,t)=>{ne&&ne.hashes||(ne={hashes:A.hashes,version:A.version});let r=e;/(\.csv|\.json)/.test(e)||(r=e+".csv");const n=A.hashes[r];n&&(ne.hashes[r]=n),ne[e]=t;const o=JSON.stringify(ne);try{localStorage.setItem("sczh:data",o)}catch(e){console.error(e)}},se=new Map;let ie=!1;let ce=null;const le=new Map([["AOBA",e=>e&&e.loaders&&e.Text&&e.BLEND_MODES],["SCENARIO",e=>e&&e.default&&e.default.load&&e.default._errorEvent&&e.default._handleError],["REQUEST",e=>e&&e.get&&e.post&&e.put&&e.patch],["PHRASE",e=>e&&e.default&&e.default._polyglot&&e.default._polyglot.phrases]]),ue=new Map([["AOBA",e=>e],["SCENARIO",e=>e.default],["REQUEST",e=>e],["PHRASE",e=>e.default._polyglot.phrases]]),de=Object.freeze;Object.freeze=new Proxy(de,{apply:(e,t,[r])=>r});const fe=Function.prototype.call;let pe={Reflect:window.Reflect};Function.prototype.call=new Proxy(fe,{apply(e,t,r){var n;return(null==r||null===(n=r[3])||void 0===n?void 0:n.toString)&&"function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}"===r[3].toString()&&(ce=r[3],Function.prototype.call=fe),pe.Reflect.apply(e,t,r)}});const he=async e=>{const{moduleId:t}=await X,r=((e,t)=>{let r,n=((e,t)=>{let r=e+t,n=[];for(let o=e-t;o<=r;o++)o>=0&&o!==e&&n.push(o);return n.unshift(e),n})(e,10);for(let e=0;e<n.length;e++){let o=ce(n[e]);if(t(o)){r=o;break}}return r})(t[e],le.get(e));return ue.get(e)(r)};let me=null;async function ye(){const e=await he("PHRASE");if(e){me=await(async(e=!1)=>{if(!ie){let t=await oe("phrase");t||(t=await ee("/data/phrase.csv"),ae("phrase",t));re(t).forEach(t=>{if(null==t?void 0:t.id){const r=U(t.id),n=U(t.trans,!0);r&&(e?se.set(r,t.trans):n&&se.set(r,N(n)))}}),ie=!0}return se})();for(let[t,r]of me)e[t]=r}}const ve=new Map,ge=new Map,we=new Map;let be=!1;const _e=async()=>{if(!be){let e=await oe("item");e||(e=await ee("/data/item.csv"),ae("item",e));re(e).forEach(e=>{if(null==e?void 0:e.text){const t=U(e.text),r=U(e.trans,!0),n=L(e.type)||"normal";t&&r&&t!==r&&("limit"===n?ge.set(t,r):"note"===n?we.set(t,r):ve.set(t,r))}}),be=!0}return{itemMap:ve,itemLimitMap:ge,itemNoteMap:we}},Ee=new Map;let ke=!1;const Se=async()=>{if(!ke){let e=await oe("name");e||(e=await ee("/data/name.csv"),ae("name",e));re(e).forEach(e=>{const t=L(e.name),r=L(e.trans);t&&r&&t!==r&&Ee.set(t,r)}),ke=!0}return Ee};let je=new Map,xe=!1;const Ae=new Map,Ie=new Map;let Ce=!1,Re=null;const Me=e=>{const t=re(e),r=new Map,n=K();return t.forEach(e=>{const t=n(L(e.id)),o=U(e.text),a=U(e.trans,!0),s=L(e.name);o&&a&&(t&&!/^0+$/.test(t)&&"select"!==t?r.set(t,N(a)):"select"===t?r.set(o+"-select",N(a)):r.set(o,N(a))),t&&s&&"info"===t&&r.set("name",s)}),r},Oe=async()=>{if(!Ce){let e=await oe("comm-story");e||(e=await ee("/data/comm-story.csv"),ae("comm-story",e));re(e).forEach(e=>{if(null==e?void 0:e.text){const t=U(e.text),r=U(e.trans,!0);t&&r&&t!==r&&Ie.set(t,r)}}),Ce=!0}return Ie};let Te=new Map,Pe=!1;const $e=async()=>{if(!Pe){let e=await oe("type-text");e||(e=await ee("/data/type-text.csv"),ae("type-text",e));re(e).forEach(e=>{if(null==e?void 0:e.text){const t=U(e.text),r=U(e.trans,!0);t&&r&&t!==r&&Te.set(t,r)}});const t=await Oe();Te=new Map([...t,...Te]),Pe=!0}return Te};let De=new Map,ze=new Map;const Fe=[],Ne=e=>{e&&e.fontFamily&&(e.fontFamily===R.HEITI_JA?Reflect.set(e,"fontFamily",R.HEITI_TRANS):e.fontFamily===R.YUAN_JA&&Reflect.set(e,"fontFamily",R.YUAN_TRANS))},Le=(e,t,r)=>{let n=e,o=B(e);return t.has(o)?(n="​"+t.get(o),Ne(r)):e.startsWith("​")||(e=>{e&&e.fontFamily&&(e.fontFamily===R.HEITI_TRANS?Reflect.set(e,"fontFamily",R.HEITI_JA):e.fontFamily===R.YUAN_TRANS&&Reflect.set(e,"fontFamily",R.YUAN_JA))})(r),n},Ue=(e,t,r=!1)=>{if(!v(e))return e;let n=e;return e.startsWith("​")?Ne(t):e.trim()&&(r?(n=Le(e,ze,t),(e=>{Fe.push(e),A.dev,setTimeout(()=>Fe.shift(),1e4)})(e)):(e=>{let t=!1;return Fe.forEach(r=>{r.startsWith(e)&&(t=!0)}),t})(e)||e.startsWith("‌")||(n=Le(e,De,t))),n};async function Be(){const e=await he("AOBA");try{De=await(async()=>{if(!xe){let e=await oe("common");e||(e=await ee("/data/common.csv"),ae("common",e));re(e).forEach(e=>{if(null==e?void 0:e.text){const t=U(e.text),r=U(e.trans,!0);t&&r&&t!==r&&je.set(t,r)}});const{itemMap:t}=await _e(),r=await Se();je=new Map([...t,...r,...je]),xe=!0}return je})(),ze=await $e()}catch(e){}const t=e.Text.prototype.typeText;e.Text.prototype.typeText=function(...e){const r=e[0];return e[0]=Ue(r,this.style,!0),t.apply(this,e)};const r=e.Text.prototype.updateText;e.Text.prototype.updateText=function(e){if(this.localStyleID!==this._style.styleID&&(this.dirty=!0,this._style.styleID),this.dirty||!e){A.dev,0;const t=Ue(this._text,this._style);return Reflect.set(this,"_text",t),r.call(this,e)}}}const He=new Map,Je=(e,t,r=[])=>{if(He.has(e))return He.get(e);let n=e;for(let[e,o]of t)n=n.replace(e,(...e)=>{let t=o;for(let n=1;n<e.length-2;n++){let o=e[n],a=!1;r.forEach(e=>{e.has(o)&&(t=t.replace("$"+n,e.get(o)),a=!0)}),a||(t=t.replace("$"+n,e[n]))}return t}),e.lastIndex=0;return He.set(e,n),n},We=(e,t,r)=>{if(!e||!v(e[t]))return;const{expMap:n,wordMaps:o,textMap:a}=r,s=B(e[t]);let i=s;s&&((null==a?void 0:a.has(s))?e[t]=N(a.get(s)):(i=Je(s,n,o),s!==i&&(e[t]=N(i))))},qe=(e,t="EMPTY")=>e.sort((e,r)=>{let n=e,o=r;return"EMPTY"!==t&&(n=e[t],o=r[t]),o||(o=""),n||(n=""),o.length>n.length?1:n.length>o.length?-1:0}),Ge=(e,t=[])=>{let r=e.replace(/\./g,"\\.").replace(/\$num/g,"([+-＋－]?[0-9０-９①-─]{1,10}\\.?[0-9０-９①-─]{0,4}?)").replace(/\$percent/g,"([+-＋－]?[0-9０-９]{1,10}\\.?[0-9０-９]{0,4}?[%％])").replace(/\$unknown/g,"(.+?)").replace(/\$uk/g,"(.+?)");return t.forEach(e=>{r=r.replace(e.re,e.exp),e.re.lastIndex=0}),new RegExp(r,"gi")},Ye={expMap:new Map,nounMap:new Map,nounArr:[],loaded:!1},Ke=async()=>{const{expMap:e,nounMap:t,nounArr:r,loaded:n}=Ye;if(!n){let n=await oe("support-skill");n||(n=await ee("/data/support-skill.csv"),ae("support-skill",n));const o=re(n),a=new Map;qe(o,"text").forEach(e=>{if(null==e?void 0:e.text){const n=U(e.text),o=U(e.trans,!0),s=L(e.type);n&&o&&("noun"===s?(r.push(H(n)),t.set(n,o)):a.set(n,o))}});const s=[{re:/\$noun/g,exp:`(${r.join("|")})`}];for(let[t,r]of a){const n=Ge(t,s);e.set(n,r)}Ye.loaded=!0}return{expMap:e,wordMaps:[t]}},Qe={expMap:new Map,textMap:new Map,nounMap:new Map,nameMap:new Map,otherMap:new Map,nounArr:[],nameArr:[],otherArr:[],loaded:!1};let Ve=null,Ze=null;const Xe=async()=>{Ve||(Ve=(async()=>{const{expMap:e,nounMap:t,textMap:r,nameMap:n,otherMap:o,nounArr:a,nameArr:s,otherArr:i,loaded:c}=Qe;if(!c){let c=await oe("skill");c||(c=await ee("/data/skill.csv"),ae("skill",c));const l=re(c),u=new Map;qe(l,"text").forEach(e=>{if(null==e?void 0:e.text){const c=U(e.text),l=U(e.trans,!0),d=L(e.type);c&&l&&("noun"===d?(a.push(H(c)),t.set(c,l)):"text"===d?r.set(c,l):"name"===d?(s.push(H(c)),n.set(c,l)):"other"===d?(i.push(H(c)),o.set(c,l)):u.set(c.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),l))}});const d=[{re:/\$noun/g,exp:`(${a.join("|")})`},{re:/\$name/g,exp:`(${s.join("|")})`},{re:/\$other/g,exp:`(${i.join("|")})`}];for(let[t,r]of u){const n=Ge(t,d);e.set(n,r)}Qe.loaded=!0}return{expMap:e,wordMaps:[t,o,n],textMap:r}})()),Ze||(Ze=await Ve)},et=(e,t)=>{if(!t){let t=[];return e.forEach((r,n)=>{let o=r.match(/([＋+]+)$/);(null==o?void 0:o[1])?(t.push(o[1]),e[n]=r.replace(/[＋+]+$/,"")):t.push("")}),t}e.forEach((r,n)=>{e[n]=r+t[n]})},tt=(e,t,r=Ze)=>{if(null==e?void 0:e[t]){let n=e[t].split("/");n.forEach((e,t)=>{let o=et(n);We(n,t,r),et(n,o)});let o=n.join("/");o!==e[t]&&(e[t]=N(o))}},rt=(e,t)=>{null==e||e.forEach(e=>{tt(e,"description",t),tt(e,"name",t)})},nt=async e=>{var t,r;const n=await Ke(),o=null!==(t=e.userSupportIdol)&&void 0!==t?t:e;rt(o.acquiredSupportSkills,n),rt(o.supportSkills,n),rt(null===(r=o.supportIdol)||void 0===r?void 0:r.supportSkills,n)},ot=e=>{var t,r;null===(t=e.skillEffects)||void 0===t||t.forEach(e=>{tt(e,"effectName"),tt(e,"effectDescription")}),null===(r=e.rivalMemoryAppealEffects)||void 0===r||r.forEach(e=>{tt(e,"effectName"),tt(e,"effectDescription")})},at=(e,t=!1)=>{e&&(tt(e,"comment"),tt(e,"name"),t&&ot(e),e.linkSkill&&(tt(e.linkSkill,"comment"),tt(e.linkSkill,"name"),t&&ot(e.linkSkill)))},st=e=>{tt(e,"name"),tt(e,"description")},it=e=>{e&&e.forEach(e=>{tt(e,"releaseConditions"),tt(e.passiveSkills,"comment"),tt(e.passiveSkills,"name"),at(e.skill),at(e.concertActiveSkill),e.activeSkills&&e.activeSkills.forEach(e=>{at(e)})})},ct=e=>{e.forEach(e=>{at(e)})},lt=(e,t=!1)=>{var r,n,o,a;let s=e.userProduceIdol;s&&(null===(r=s.activeSkills)||void 0===r||r.forEach(e=>{at(e)}),null===(n=s.abilities)||void 0===n||n.forEach(e=>{at(e)}),null===(o=s.passiveSkills)||void 0===o||o.forEach(e=>{at(e)}),null===(a=s.limitBreaks)||void 0===a||a.forEach(e=>{at(e)}),t&&it(s.skillPanels))},ut=e=>{e.forEach(e=>{at(e.skill,!0)})},dt=e=>{e&&e.forEach(e=>{var t,r,n;null===(t=e.userFesDeck)||void 0===t||t.userFesDeckMembers.forEach(e=>{e.userFesIdol.activeSkills.forEach(e=>{ot(e)})}),null===(r=e.userRaidDeck)||void 0===r||r.userRaidDeckMembers.forEach(e=>{e.userFesIdol.activeSkills.forEach(e=>{at(e,!0)})}),null===(n=e.rival)||void 0===n||n.rivalSkills.forEach(e=>{ot(e)})})},ft=async e=>{await Xe(),it(e.idol.skillPanels),ct(e.idol.memoryAppeals),e.userIdolProduceExSkills.forEach(e=>{st(e.produceExSkill)})},pt=async e=>{var t,r,n,o;await Xe(),it(e.supportIdol.skillPanels),null===(t=e.userSupportIdolProduceExSkills)||void 0===t||t.forEach(e=>{st(e.produceExSkill)}),null===(r=e.supportIdol)||void 0===r||null===(n=r.supportIdolActiveSkill)||void 0===n||null===(o=n.activeSkills)||void 0===o||o.forEach(e=>{tt(e,"comment"),tt(e,"name")})},ht=async e=>{await Xe();const t=e.userFesIdol;t.activeSkills.forEach(e=>{at(e)}),t.abilities.forEach(e=>{at(e)}),at(t.memoryAppeal),t.passiveSkills.forEach(e=>{tt(e,"comment"),tt(e,"name")}),t.userFesIdolProduceExSkills.forEach(e=>{st(e.produceExSkill)}),t.userFesSupportIdols.forEach(e=>{e.userFesSupportIdolProduceExSkills.forEach(e=>{st(e.produceExSkill)})})},mt=ht,yt=async e=>{await Xe(),e.userProduceExSkills.forEach(e=>{st(e.produceExSkill)})},vt=async e=>{var t,r,n,o;await Xe(),e.userProduceSupportIdols.forEach(e=>{it(e.skillPanels)}),lt(e,!0),null===(t=e.userProduceLimitedSkills)||void 0===t||t.forEach(e=>{at(e.passiveSkills),at(e.skill)}),it(null===(r=e.userProduceIdol)||void 0===r||null===(n=r.userIdol)||void 0===n||null===(o=n.idol)||void 0===o?void 0:o.skillPanels)},gt=async e=>{var t,r;await Xe();const n=e=>{e.userFesIdol.activeSkills.forEach(e=>{at(e,!0)}),e.userFesIdol.abilities.forEach(e=>{at(e)}),e.userFesIdol.concertAbilities.forEach(e=>{at(e)}),at(e.userFesIdol.memoryAppeal,!0),e.userFesIdol.passiveSkills.forEach(e=>{tt(e,"comment"),tt(e,"name"),ot(e)})};null===(t=e.userFesDeck)||void 0===t||t.userFesDeckMembers.forEach(n),null===(r=e.userRaidDeck)||void 0===r||r.userRaidDeckMembers.forEach(n),ut(e.judges),dt(e.userFesRivals),dt(e.userFesRaidRivals)},wt=async e=>{var t,r,n;await Xe(),null===(t=e.fanActiveSkills)||void 0===t||t.forEach(e=>{at(e,!0)}),e.userProduceSupportIdols.forEach(e=>{at(e.activeSkill,!0)});let o=e.userProduceIdol;o.activeSkills.forEach(e=>{at(e,!0)}),null===(r=o.abilities)||void 0===r||r.forEach(e=>{at(e,!0)}),null===(n=o.concertAbilities)||void 0===n||n.forEach(e=>{at(e,!0)}),at(o.memoryAppeal,!0),o.passiveSkills.forEach(e=>{at(e,!0)});let a=e.produceAudition||e.produceConcert;ut(a.judges),(e=>{e.forEach(e=>{ot(e.rivalMemoryAppeal),e.rivalSkills.forEach(e=>{ot(e)})})})(a.rivals)},bt=async e=>{if(e.gameData)try{let t=JSON.parse(e.gameData);t.produceAudition||t.produceConcert?await wt(t):(t.userFesDeck||t.userRaidDeck)&&await gt(t),e.gameData=JSON.stringify(t)}catch(e){J(e)}},_t=async e=>{await Xe(),e.userProduceIdol.activeSkills.forEach(e=>{at(e)}),e.userProduceIdol.abilities.forEach(e=>{at(e)}),e.userProduceAbilities.forEach(e=>{at(e.ability),tt(e.ability,"acquireComment"),e.ability.produceAbilityAcquireConditionComments.forEach(e=>{tt(e,"name")})})};let Et=new Map,kt=new Map,St=new Map,jt=new Map,xt=new Map,At=!1;const It=["produceItem","recoveryItem","exchangeItem","lotteryTicket","evolutionItem","gashaTicket","scoutTicket","enhancementItem"];let Ct,Rt;const Mt=async()=>{Rt||(Rt=_e()),Ct||(Ct=await Rt)};let Ot=[];(window.unsafeWindow||window).printUnknowItems=()=>J(Ot.join("\n"));const Tt=(e,t)=>{if(!e||"string"!=typeof e[t])return;const{itemMap:r,itemLimitMap:n,itemNoteMap:o}=Ct;let a=B(e[t]),s="",i="",c="";if(/[\s\S]+[\r\n]{0,2}\[[^\]]+\]$/.test(a)){let e=a.match(/([\s\S]+)([\r\n]{0,2}\[[^\]]+\])$/);a=e[1].trim();let t=e[2];s=n.has(t)?n.get(t):t}if(/[\s\S]+[\r\n]{0,2}【Exp:\d+】$/.test(a)){let e=a.match(/([\s\S]+)([\r\n]{0,2}【Exp:\d+】)$/);a=e[1].trim(),c=e[2]}if(/[\s\S]+[\r\n]{0,2}[(（][^)）]+[）)]$/.test(a)){let e=a.match(/([\s\S]+)([\r\n]{0,2})[(（]([^)）]+)[）)]$/);a=e[1].trim();let t=e[3];i=o.has(t)?`${e[2]}（${o.get(t)}）`:e[2]+"（txt）"}if(r.has(a)){let n=r.get(a);n=`${n}${i}${c}${s}`,e[t]=N(n)}else A.dev&&(e=>{if(!e)return;let t=W(e);Ot.includes(t)||Ot.push(t)})(e[t])},Pt=e=>{var t;null==e||null===(t=e.shopMerchandises)||void 0===t||t.forEach(e=>{Tt(e,"title"),Tt(e,"shopTitle"),Tt(e,"comment")})},$t=async e=>{let t=e;e.userProduceItems&&(t=e.userProduceItems),await Mt(),Array.isArray(t)&&t.forEach(e=>{const t=e[It[0]]||e[It[1]]||e[It[2]]||e[It[3]]||e[It[4]]||e[It[5]]||e[It[6]]||e[It[7]];Tt(t,"name"),Tt(t,"comment")})},Dt=async e=>{await Mt(),e.accumulatedPresent.userGameEventAccumulatedPresents.forEach(e=>{e.gameEventAccumulatedPresent.rewards.forEach(e=>{Tt(e.content,"name")})})},zt=async e=>{var t;await Mt(),null==e||null===(t=e.activeProduceItems)||void 0===t||t.forEach(e=>{Tt(e.produceItem,"name"),Tt(e.produceItem,"comment")})};let Ft=null,Nt=null;const Lt=async()=>{Nt||(Nt=(async(e=!1)=>{if(!At){let e=await oe("mission-re");e||(e=await ee("/data/mission-re.csv"),ae("mission-re",e));const t=re(e),r=[],n=[],o=[],a=new Map;qe(t,"text").forEach(e=>{if(null==e?void 0:e.text){const t=U(e.text),s=U(e.trans,!0),i=L(e.type);t&&s&&("noun"===i?(r.push(H(t)),St.set(t,s)):"note"===i?(o.push(H(t)),xt.set(t,s),a.set(`【${t}】`,`【${s}】`)):"name"===i?(n.push(H(t)),jt.set(t,s)):"exp"===i&&a.set(t,s),"exp"!==i&&Et.set(t,s))}});const s=[{re:/\$name/g,exp:`(${n.join("|")})`},{re:/\$noun/g,exp:`(${r.join("|")})`},{re:/\$note/g,exp:`(${o.join("|")})`}];for(let[e,t]of a){const r=Ge(e,s);kt.set(r,t)}At=!0}const t=[St,xt,jt];let{itemMap:r}=await _e();return Et=new Map([...r,...Et]),{expMap:kt,wordMaps:t,textMap:Et}})()),await Mt(),Ft=await Nt},Ut=(e,t)=>{let r=!1;if(!e||"string"!=typeof e[t])return r;const{expMap:n,wordMaps:o,textMap:a}=Ft,s=B(e[t]);let i=s;return s?(a.has(s)?(r=!0,e[t]=N(a.get(s))):(i=Je(s,n,o),s!==i?(r=!0,e[t]=N(i)):A.dev&&Gt(e,t)),r):r},Bt=(e,t)=>{Ut(e,t)||Tt(e,t)},Ht=e=>{null==e||e.forEach(e=>{Ut(e.mission,"title"),Ut(e.mission,"comment"),e.mission.missionReward.content&&(Bt(e.mission.missionReward.content,"name"),Bt(e.mission.missionReward.content,"comment"))})},Jt=e=>{e.forEach(e=>{let t=e.fesRaidAccumulatedReward;Ut(t,"title"),Ut(t,"comment");let r=t.fesRaidAccumulatedRewardContent;(null==r?void 0:r.content)&&(Bt(r.content,"name"),Bt(r.content,"comment"))})},Wt=(e,t=!0)=>{null==e||e.forEach(e=>{let r=e.mission||e;if(Ut(r,"title"),Ut(r,"comment"),Ut(r,"afterAchievedComment"),Ut(r,"beforeAchievedComment"),t){let e=r.lectureMissionReward;(null==e?void 0:e.content)&&(Bt(e.content,"name"),Bt(e.content,"comment"))}})},qt=[],Gt=(e,t)=>{if(!e[t])return;const r=W(e[t]);qt.includes(r)||qt.push(r)};(window.unsafeWindow||window).printUnknownMission=()=>J(qt.join("\n"));const Yt=async e=>{var t,r;await Lt(),Ut(null===(t=e.userRecommendedMission)||void 0===t?void 0:t.mission,"comment"),Ut(null===(r=e.userRecommendedMission)||void 0===r?void 0:r.mission,"title"),e.accumulatedPresent.userGameEventAccumulatedPresents.forEach(e=>{Ut(e.gameEventAccumulatedPresent,"comment"),Ut(e.gameEventAccumulatedPresent,"title")})},Kt=async e=>{var t;await Lt(),null===(t=e.teachingHints)||void 0===t||t.forEach(e=>{var t,r;null===(t=e.userProduceHints)||void 0===t||t.forEach(e=>{Ut(e.produceTeachingHint,"title")}),null===(r=e.userProduceTeachingHints)||void 0===r||r.forEach(e=>{Ut(e.produceTeachingHint,"title")})})},Qt=async e=>{await Lt(),Wt(e.lectureMissions)},Vt=e=>{var t;null===(t=e.userIdolRoad)||void 0===t||t.idolRoad.idolRoadRewards.forEach(e=>{Bt(e.content,"name"),Bt(e.content,"comment")})},Zt=new Map,Xt=new Map,er=new Map;let tr=!1;let rr,nr,or,ar;const sr=async()=>{or||(or=(async()=>{if(!tr){let e=await oe("title");e||(e=await ee("/data/title.csv"),ae("title",e));re(e).forEach(e=>{if(null==e?void 0:e.text){const t=U(e.text),r=U(e.trans,!0),n=L(e.type)||"text";t&&r&&t!==r&&("exp"===n?Xt.set(t,r):"text"===n&&Zt.set(t,r))}});for(let[e,t]of Xt){const r=Ge(e);er.set(r,t)}tr=!0}return{textMap:Zt,expMap:er}})(),ar=Se()),rr&&nr||(rr=await or,nr=await ar,rr.wordMaps=[nr])};let ir=[];(window.unsafeWindow||window).printUnknowTitles=()=>J(ir.join("\n"));const cr=new Map,lr=(e,t)=>{e&&v(t)&&(cr.has(e)||cr.set(e,t))},ur=(e={},t)=>{let r=e[t];We(e,t,rr),A.dev&&r===e[t]&&(e=>{if(!e)return;let t=W(e);ir.includes(t)||ir.push(t)})(r)},dr=e=>{e.forEach(e=>{ur(e,"name"),e.communications.forEach(e=>{ur(e,"name"),ur(e,"title"),lr(e.id,`${e.name}-${e.title}`)})})};var fr=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]+t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]+t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]+t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]+t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]},pr=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var r=[0,0,0,0];return r[3]+=e[3]*t[3],r[2]+=r[3]>>>16,r[3]&=65535,r[2]+=e[2]*t[3],r[1]+=r[2]>>>16,r[2]&=65535,r[2]+=e[3]*t[2],r[1]+=r[2]>>>16,r[2]&=65535,r[1]+=e[1]*t[3],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[2]*t[2],r[0]+=r[1]>>>16,r[1]&=65535,r[1]+=e[3]*t[1],r[0]+=r[1]>>>16,r[1]&=65535,r[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],r[0]&=65535,[r[0]<<16|r[1],r[2]<<16|r[3]]},hr=function(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])},mr=function(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]},yr=function(e,t){return[e[0]^t[0],e[1]^t[1]]},vr=function(e){return e=yr(e,[0,e[0]>>>1]),e=pr(e,[4283543511,3981806797]),e=yr(e,[0,e[0]>>>1]),e=pr(e,[3301882366,444984403]),e=yr(e,[0,e[0]>>>1])};let gr="";const wr=()=>{let e="0123456789abcdefghijklmnopqrstuvwxyz",t="";for(let r=0;r<33;r++)t+=e[Math.floor(Math.random()*e.length)];gr=function(e,t){t=t||0;for(var r=(e=e||"").length%16,n=e.length-r,o=[0,t],a=[0,t],s=[0,0],i=[0,0],c=[2277735313,289559509],l=[1291169091,658871167],u=0;u<n;u+=16)s=[255&e.charCodeAt(u+4)|(255&e.charCodeAt(u+5))<<8|(255&e.charCodeAt(u+6))<<16|(255&e.charCodeAt(u+7))<<24,255&e.charCodeAt(u)|(255&e.charCodeAt(u+1))<<8|(255&e.charCodeAt(u+2))<<16|(255&e.charCodeAt(u+3))<<24],i=[255&e.charCodeAt(u+12)|(255&e.charCodeAt(u+13))<<8|(255&e.charCodeAt(u+14))<<16|(255&e.charCodeAt(u+15))<<24,255&e.charCodeAt(u+8)|(255&e.charCodeAt(u+9))<<8|(255&e.charCodeAt(u+10))<<16|(255&e.charCodeAt(u+11))<<24],s=pr(s,c),s=hr(s,31),s=pr(s,l),o=yr(o,s),o=hr(o,27),o=fr(o,a),o=fr(pr(o,[0,5]),[0,1390208809]),i=pr(i,l),i=hr(i,33),i=pr(i,c),a=yr(a,i),a=hr(a,31),a=fr(a,o),a=fr(pr(a,[0,5]),[0,944331445]);switch(s=[0,0],i=[0,0],r){case 15:i=yr(i,mr([0,e.charCodeAt(u+14)],48));case 14:i=yr(i,mr([0,e.charCodeAt(u+13)],40));case 13:i=yr(i,mr([0,e.charCodeAt(u+12)],32));case 12:i=yr(i,mr([0,e.charCodeAt(u+11)],24));case 11:i=yr(i,mr([0,e.charCodeAt(u+10)],16));case 10:i=yr(i,mr([0,e.charCodeAt(u+9)],8));case 9:i=yr(i,[0,e.charCodeAt(u+8)]),i=pr(i,l),i=hr(i,33),i=pr(i,c),a=yr(a,i);case 8:s=yr(s,mr([0,e.charCodeAt(u+7)],56));case 7:s=yr(s,mr([0,e.charCodeAt(u+6)],48));case 6:s=yr(s,mr([0,e.charCodeAt(u+5)],40));case 5:s=yr(s,mr([0,e.charCodeAt(u+4)],32));case 4:s=yr(s,mr([0,e.charCodeAt(u+3)],24));case 3:s=yr(s,mr([0,e.charCodeAt(u+2)],16));case 2:s=yr(s,mr([0,e.charCodeAt(u+1)],8));case 1:s=yr(s,[0,e.charCodeAt(u)]),s=pr(s,c),s=hr(s,31),s=pr(s,l),o=yr(o,s)}return o=yr(o,[0,e.length]),a=yr(a,[0,e.length]),o=fr(o,a),a=fr(a,o),o=vr(o),a=vr(a),o=fr(o,a),a=fr(a,o),("00000000"+(o[0]>>>0).toString(16)).slice(-8)+("00000000"+(o[1]>>>0).toString(16)).slice(-8)+("00000000"+(a[0]>>>0).toString(16)).slice(-8)+("00000000"+(a[1]>>>0).toString(16)).slice(-8)}(t,31),localStorage.setItem("sczh:bid",gr)};try{gr=localStorage.getItem("sczh:bid")}catch(e){}gr||wr();var br=Object.prototype.hasOwnProperty,_r=Array.isArray,Er=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),kr=function(e,t){for(var r=t&&t.plainObjects?Object.create(null):{},n=0;n<e.length;++n)void 0!==e[n]&&(r[n]=e[n]);return r},Sr={arrayToObject:kr,assign:function(e,t){return Object.keys(t).reduce((function(e,r){return e[r]=t[r],e}),e)},combine:function(e,t){return[].concat(e,t)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],r=[],n=0;n<t.length;++n)for(var o=t[n],a=o.obj[o.prop],s=Object.keys(a),i=0;i<s.length;++i){var c=s[i],l=a[c];"object"==typeof l&&null!==l&&-1===r.indexOf(l)&&(t.push({obj:a,prop:c}),r.push(l))}return function(e){for(;e.length>1;){var t=e.pop(),r=t.obj[t.prop];if(_r(r)){for(var n=[],o=0;o<r.length;++o)void 0!==r[o]&&n.push(r[o]);t.obj[t.prop]=n}}}(t),e},decode:function(e,t,r){var n=e.replace(/\+/g," ");if("iso-8859-1"===r)return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch(e){return n}},encode:function(e,t,r){if(0===e.length)return e;var n=e;if("symbol"==typeof e?n=Symbol.prototype.toString.call(e):"string"!=typeof e&&(n=String(e)),"iso-8859-1"===r)return escape(n).replace(/%u[0-9a-f]{4}/gi,(function(e){return"%26%23"+parseInt(e.slice(2),16)+"%3B"}));for(var o="",a=0;a<n.length;++a){var s=n.charCodeAt(a);45===s||46===s||95===s||126===s||s>=48&&s<=57||s>=65&&s<=90||s>=97&&s<=122?o+=n.charAt(a):s<128?o+=Er[s]:s<2048?o+=Er[192|s>>6]+Er[128|63&s]:s<55296||s>=57344?o+=Er[224|s>>12]+Er[128|s>>6&63]+Er[128|63&s]:(a+=1,s=65536+((1023&s)<<10|1023&n.charCodeAt(a)),o+=Er[240|s>>18]+Er[128|s>>12&63]+Er[128|s>>6&63]+Er[128|63&s])}return o},isBuffer:function(e){return!(!e||"object"!=typeof e)&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,r,n){if(!r)return t;if("object"!=typeof r){if(_r(t))t.push(r);else{if(!t||"object"!=typeof t)return[t,r];(n&&(n.plainObjects||n.allowPrototypes)||!br.call(Object.prototype,r))&&(t[r]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(r);var o=t;return _r(t)&&!_r(r)&&(o=kr(t,n)),_r(t)&&_r(r)?(r.forEach((function(r,o){if(br.call(t,o)){var a=t[o];a&&"object"==typeof a&&r&&"object"==typeof r?t[o]=e(a,r,n):t.push(r)}else t[o]=r})),t):Object.keys(r).reduce((function(t,o){var a=r[o];return br.call(t,o)?t[o]=e(t[o],a,n):t[o]=a,t}),o)}},jr=String.prototype.replace,xr=/%20/g,Ar={RFC1738:"RFC1738",RFC3986:"RFC3986"},Ir=Sr.assign({default:Ar.RFC3986,formatters:{RFC1738:function(e){return jr.call(e,xr,"+")},RFC3986:function(e){return String(e)}}},Ar),Cr=(Date.prototype.toISOString,Ir.default);Ir.formatters[Cr];const Rr=async e=>{const t={text:e};try{const e="https://hooks.sla"+"ck.com/services/TN6J76CUB/BNJ2"+"YLNR3/baGxj31D5YxNhL2Q9FcbzaTA";await((e,t)=>{const{method:r="GET",headers:n,data:o}=t;return fetch(e,{body:o,headers:n,method:r,mode:"cors",referrer:"no-referrer"}).then(e=>e.json())})(e,{data:JSON.stringify(t),method:"POST",headers:{accept:"*/*",referer:"https://hooks.slack.com",origin:"https://hooks.slack.com"}});return""}catch(e){return""}},Mr=["text","select","comment","title","actionComment","actionComment2","reactionComment","resultLoseComment","resultStartComment","resultWinComment","characterComment","producerComment","comment1","comment2"];let Or=!1;const Tr=async(e,t,r)=>{if(!e.length)return;const n=await Se(),o=await $e(),{textInfo:a,textList:s}=((e,t,r)=>{const n=[],o=[];return e.forEach((e,a)=>{Mr.forEach(s=>{let i=B(e[s]);e[s]&&(t.has(i)?e[s]=N(t.get(i)):r.has(i)?e[s]=N(r.get(i)):(n.push({key:s,index:a}),o.push(i)))})}),{textInfo:n,textList:o}})(e,n,o);if(a.length&&"……"!=s&&1!=Or&&"…………"!=s&&"………………\n……………………\n…………………………"!=s&&!(a.length>9)){if(r){let e=[];s.forEach((t,r)=>{e.push(W(t))});const t=e.join("\n"),r=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/,n=[];["…………","……","………………\n……………………\n…………………………"].forEach(e=>{n.push(W(e))}),r.test(t)||n.includes(e[0])||await Rr(t),Or=!0}else{let e=[];s.forEach((t,r)=>{e.push("commstory"+W(t))});const t=e.join("\n"),r=/[ㄱ-ㅎ|ㅏ-ㅣ|가-힣]/,n=[];["…………","……","………………\n……………………\n…………………………"].forEach(e=>{n.push(W(e))}),r.test(t)||n.includes(e[0])||await Rr(t),Or=!0}e.forEach(e=>{Y(e,n)})}},Pr=async(e,t="comment")=>{if(!e)return;e.map(e=>e[t]).join("").trim();await Tr(e,0,!0)},$r=["actionComment","actionComment2","reactionComment","resultLoseComment","resultStartComment","resultWinComment"],Dr=async e=>{try{if(e.produceAudition){e.produceAudition.judges.map(e=>$r.map(t=>e[t]||"").join("")).join("").trim();await Tr(e.produceAudition.judges,0,!0)}if(e.produceConcert){e.produceConcert.judges.map(e=>$r.map(t=>e[t]||"").join("")).join("").trim();await Tr(e.produceConcert.judges,0,!0)}e.produceConcertFanSkillComments&&await Pr(e.produceConcertFanSkillComments,"comment1")}catch(e){J(e)}},zr=async e=>{if(e.judges){e.judges.map(e=>$r.map(t=>e[t]||"").join("")).join("").trim();await Tr(e.judges,0,!0)}},Fr=async e=>{if(e.topCharacterReaction)try{const t=[...e.topCharacterReaction.moveReactions,...e.topCharacterReaction.skillReleasedReactions,...e.topCharacterReaction.touchExReactions,...e.topCharacterReaction.touchReactions,...e.topCharacterReaction.waitReactions];await Pr(t)}catch(e){J(e)}},Nr=async e=>{let t=[...e.produceStaffComments||[],...e.produceStaffConcertComments||[],...e.produceStaffFailComments||[],...e.produceStaffSeasonComments||[]];await Pr(t)},Lr=async e=>{if(e.gameData)try{let t=JSON.parse(e.gameData);t.judges?await zr(t):await Dr(t),e.gameData=JSON.stringify(t)}catch(e){J(e)}},Ur=async e=>{if(!e.characterComment)return;let t=[];t=t.concat(e.characterComment),await Pr(t)},Br=async e=>{const t=await Se();if(e.userProduceIdol){const r=e.userProduceIdol.userIdol.idol.character;t.has(r.name)&&(r.name=t.get(r.name)),t.has(r.firstName)&&(r.firstName=N(t.get(r.firstName)))}},Hr=async e=>{var t;await sr(),null===(t=e.produceEvents)||void 0===t||t.forEach(e=>{ur(e,"title"),lr(e.id,e.title)})};var Jr=function(){this.__data__=[],this.size=0};var Wr=function(e,t){return e===t||e!=e&&t!=t};var qr=function(e,t){for(var r=e.length;r--;)if(Wr(e[r][0],t))return r;return-1},Gr=Array.prototype.splice;var Yr=function(e){var t=this.__data__,r=qr(t,e);return!(r<0)&&(r==t.length-1?t.pop():Gr.call(t,r,1),--this.size,!0)};var Kr=function(e){var t=this.__data__,r=qr(t,e);return r<0?void 0:t[r][1]};var Qr=function(e){return qr(this.__data__,e)>-1};var Vr=function(e,t){var r=this.__data__,n=qr(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function Zr(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Zr.prototype.clear=Jr,Zr.prototype.delete=Yr,Zr.prototype.get=Kr,Zr.prototype.has=Qr,Zr.prototype.set=Vr;var Xr=Zr;var en=function(){this.__data__=new Xr,this.size=0};var tn=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r};var rn=function(e){return this.__data__.get(e)};var nn=function(e){return this.__data__.has(e)};var on=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var an,sn=function(e){if(!on(e))return!1;var t=h(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},cn=o["__core-js_shared__"],ln=(an=/[^.]+$/.exec(cn&&cn.keys&&cn.keys.IE_PROTO||""))?"Symbol(src)_1."+an:"";var un=function(e){return!!ln&&ln in e},dn=Function.prototype.toString;var fn=function(e){if(null!=e){try{return dn.call(e)}catch(e){}try{return e+""}catch(e){}}return""},pn=/^\[object .+?Constructor\]$/,hn=Function.prototype,mn=Object.prototype,yn=hn.toString,vn=mn.hasOwnProperty,gn=RegExp("^"+yn.call(vn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var wn=function(e){return!(!on(e)||un(e))&&(sn(e)?gn:pn).test(fn(e))};var bn=function(e,t){return null==e?void 0:e[t]};var _n=function(e,t){var r=bn(e,t);return wn(r)?r:void 0},En=_n(o,"Map"),kn=_n(Object,"create");var Sn=function(){this.__data__=kn?kn(null):{},this.size=0};var jn=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},xn=Object.prototype.hasOwnProperty;var An=function(e){var t=this.__data__;if(kn){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return xn.call(t,e)?t[e]:void 0},In=Object.prototype.hasOwnProperty;var Cn=function(e){var t=this.__data__;return kn?void 0!==t[e]:In.call(t,e)};var Rn=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=kn&&void 0===t?"__lodash_hash_undefined__":t,this};function Mn(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Mn.prototype.clear=Sn,Mn.prototype.delete=jn,Mn.prototype.get=An,Mn.prototype.has=Cn,Mn.prototype.set=Rn;var On=Mn;var Tn=function(){this.size=0,this.__data__={hash:new On,map:new(En||Xr),string:new On}};var Pn=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var $n=function(e,t){var r=e.__data__;return Pn(t)?r["string"==typeof t?"string":"hash"]:r.map};var Dn=function(e){var t=$n(this,e).delete(e);return this.size-=t?1:0,t};var zn=function(e){return $n(this,e).get(e)};var Fn=function(e){return $n(this,e).has(e)};var Nn=function(e,t){var r=$n(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function Ln(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Ln.prototype.clear=Tn,Ln.prototype.delete=Dn,Ln.prototype.get=zn,Ln.prototype.has=Fn,Ln.prototype.set=Nn;var Un=Ln;var Bn=function(e,t){var r=this.__data__;if(r instanceof Xr){var n=r.__data__;if(!En||n.length<199)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new Un(n)}return r.set(e,t),this.size=r.size,this};function Hn(e){var t=this.__data__=new Xr(e);this.size=t.size}Hn.prototype.clear=en,Hn.prototype.delete=tn,Hn.prototype.get=rn,Hn.prototype.has=nn,Hn.prototype.set=Bn;var Jn=Hn;var Wn=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e},qn=function(){try{var e=_n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Gn=function(e,t,r){"__proto__"==t&&qn?qn(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Yn=Object.prototype.hasOwnProperty;var Kn=function(e,t,r){var n=e[t];Yn.call(e,t)&&Wr(n,r)&&(void 0!==r||t in e)||Gn(e,t,r)};var Qn=function(e,t,r,n){var o=!r;r||(r={});for(var a=-1,s=t.length;++a<s;){var i=t[a],c=n?n(r[i],e[i],i,r,e):void 0;void 0===c&&(c=e[i]),o?Gn(r,i,c):Kn(r,i,c)}return r};var Vn=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n};var Zn=function(e){return y(e)&&"[object Arguments]"==h(e)},Xn=Object.prototype,eo=Xn.hasOwnProperty,to=Xn.propertyIsEnumerable,ro=Zn(function(){return arguments}())?Zn:function(e){return y(e)&&eo.call(e,"callee")&&!to.call(e,"callee")};var no=function(){return!1},oo=t((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?o.Buffer:void 0,s=(a?a.isBuffer:void 0)||no;e.exports=s})),ao=/^(?:0|[1-9]\d*)$/;var so=function(e,t){var r=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==r||"symbol"!=r&&ao.test(e))&&e>-1&&e%1==0&&e<t};var io=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},co={};co["[object Float32Array]"]=co["[object Float64Array]"]=co["[object Int8Array]"]=co["[object Int16Array]"]=co["[object Int32Array]"]=co["[object Uint8Array]"]=co["[object Uint8ClampedArray]"]=co["[object Uint16Array]"]=co["[object Uint32Array]"]=!0,co["[object Arguments]"]=co["[object Array]"]=co["[object ArrayBuffer]"]=co["[object Boolean]"]=co["[object DataView]"]=co["[object Date]"]=co["[object Error]"]=co["[object Function]"]=co["[object Map]"]=co["[object Number]"]=co["[object Object]"]=co["[object RegExp]"]=co["[object Set]"]=co["[object String]"]=co["[object WeakMap]"]=!1;var lo=function(e){return y(e)&&io(e.length)&&!!co[h(e)]};var uo=function(e){return function(t){return e(t)}},fo=t((function(e,t){var n=t&&!t.nodeType&&t,o=n&&e&&!e.nodeType&&e,a=o&&o.exports===n&&r.process,s=function(){try{var e=o&&o.require&&o.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s})),po=fo&&fo.isTypedArray,ho=po?uo(po):lo,mo=Object.prototype.hasOwnProperty;var yo=function(e,t){var r=m(e),n=!r&&ro(e),o=!r&&!n&&oo(e),a=!r&&!n&&!o&&ho(e),s=r||n||o||a,i=s?Vn(e.length,String):[],c=i.length;for(var l in e)!t&&!mo.call(e,l)||s&&("length"==l||o&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||so(l,c))||i.push(l);return i},vo=Object.prototype;var go=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||vo)},wo=w(Object.keys,Object),bo=Object.prototype.hasOwnProperty;var _o=function(e){if(!go(e))return wo(e);var t=[];for(var r in Object(e))bo.call(e,r)&&"constructor"!=r&&t.push(r);return t};var Eo=function(e){return null!=e&&io(e.length)&&!sn(e)};var ko=function(e){return Eo(e)?yo(e):_o(e)};var So=function(e,t){return e&&Qn(t,ko(t),e)};var jo=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},xo=Object.prototype.hasOwnProperty;var Ao=function(e){if(!on(e))return jo(e);var t=go(e),r=[];for(var n in e)("constructor"!=n||!t&&xo.call(e,n))&&r.push(n);return r};var Io=function(e){return Eo(e)?yo(e,!0):Ao(e)};var Co=function(e,t){return e&&Qn(t,Io(t),e)},Ro=t((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,a=n&&n.exports===r?o.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}}));var Mo=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t};var Oo=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,a=[];++r<n;){var s=e[r];t(s,r,e)&&(a[o++]=s)}return a};var To=function(){return[]},Po=Object.prototype.propertyIsEnumerable,$o=Object.getOwnPropertySymbols,Do=$o?function(e){return null==e?[]:(e=Object(e),Oo($o(e),(function(t){return Po.call(e,t)})))}:To;var zo=function(e,t){return Qn(e,Do(e),t)};var Fo=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},No=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)Fo(t,Do(e)),e=b(e);return t}:To;var Lo=function(e,t){return Qn(e,No(e),t)};var Uo=function(e,t,r){var n=t(e);return m(e)?n:Fo(n,r(e))};var Bo=function(e){return Uo(e,ko,Do)};var Ho=function(e){return Uo(e,Io,No)},Jo=_n(o,"DataView"),Wo=_n(o,"Promise"),qo=_n(o,"Set"),Go=_n(o,"WeakMap"),Yo=fn(Jo),Ko=fn(En),Qo=fn(Wo),Vo=fn(qo),Zo=fn(Go),Xo=h;(Jo&&"[object DataView]"!=Xo(new Jo(new ArrayBuffer(1)))||En&&"[object Map]"!=Xo(new En)||Wo&&"[object Promise]"!=Xo(Wo.resolve())||qo&&"[object Set]"!=Xo(new qo)||Go&&"[object WeakMap]"!=Xo(new Go))&&(Xo=function(e){var t=h(e),r="[object Object]"==t?e.constructor:void 0,n=r?fn(r):"";if(n)switch(n){case Yo:return"[object DataView]";case Ko:return"[object Map]";case Qo:return"[object Promise]";case Vo:return"[object Set]";case Zo:return"[object WeakMap]"}return t});var ea=Xo,ta=Object.prototype.hasOwnProperty;var ra=function(e){var t=e.length,r=new e.constructor(t);return t&&"string"==typeof e[0]&&ta.call(e,"index")&&(r.index=e.index,r.input=e.input),r},na=o.Uint8Array;var oa=function(e){var t=new e.constructor(e.byteLength);return new na(t).set(new na(e)),t};var aa=function(e,t){var r=t?oa(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)},sa=/\w*$/;var ia=function(e){var t=new e.constructor(e.source,sa.exec(e));return t.lastIndex=e.lastIndex,t},ca=a?a.prototype:void 0,la=ca?ca.valueOf:void 0;var ua=function(e){return la?Object(la.call(e)):{}};var da=function(e,t){var r=t?oa(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)};var fa=function(e,t,r){var n=e.constructor;switch(t){case"[object ArrayBuffer]":return oa(e);case"[object Boolean]":case"[object Date]":return new n(+e);case"[object DataView]":return aa(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return da(e,r);case"[object Map]":return new n;case"[object Number]":case"[object String]":return new n(e);case"[object RegExp]":return ia(e);case"[object Set]":return new n;case"[object Symbol]":return ua(e)}},pa=Object.create,ha=function(){function e(){}return function(t){if(!on(t))return{};if(pa)return pa(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();var ma=function(e){return"function"!=typeof e.constructor||go(e)?{}:ha(b(e))};var ya=function(e){return y(e)&&"[object Map]"==ea(e)},va=fo&&fo.isMap,ga=va?uo(va):ya;var wa=function(e){return y(e)&&"[object Set]"==ea(e)},ba=fo&&fo.isSet,_a=ba?uo(ba):wa,Ea={};Ea["[object Arguments]"]=Ea["[object Array]"]=Ea["[object ArrayBuffer]"]=Ea["[object DataView]"]=Ea["[object Boolean]"]=Ea["[object Date]"]=Ea["[object Float32Array]"]=Ea["[object Float64Array]"]=Ea["[object Int8Array]"]=Ea["[object Int16Array]"]=Ea["[object Int32Array]"]=Ea["[object Map]"]=Ea["[object Number]"]=Ea["[object Object]"]=Ea["[object RegExp]"]=Ea["[object Set]"]=Ea["[object String]"]=Ea["[object Symbol]"]=Ea["[object Uint8Array]"]=Ea["[object Uint8ClampedArray]"]=Ea["[object Uint16Array]"]=Ea["[object Uint32Array]"]=!0,Ea["[object Error]"]=Ea["[object Function]"]=Ea["[object WeakMap]"]=!1;var ka=function e(t,r,n,o,a,s){var i,c=1&r,l=2&r,u=4&r;if(n&&(i=a?n(t,o,a,s):n(t)),void 0!==i)return i;if(!on(t))return t;var d=m(t);if(d){if(i=ra(t),!c)return Mo(t,i)}else{var f=ea(t),p="[object Function]"==f||"[object GeneratorFunction]"==f;if(oo(t))return Ro(t,c);if("[object Object]"==f||"[object Arguments]"==f||p&&!a){if(i=l||p?{}:ma(t),!c)return l?Lo(t,Co(i,t)):zo(t,So(i,t))}else{if(!Ea[f])return a?t:{};i=fa(t,f,c)}}s||(s=new Jn);var h=s.get(t);if(h)return h;s.set(t,i),_a(t)?t.forEach((function(o){i.add(e(o,r,n,o,t,s))})):ga(t)&&t.forEach((function(o,a){i.set(a,e(o,r,n,a,t,s))}));var y=u?l?Ho:Bo:l?keysIn:ko,v=d?void 0:y(t);return Wn(v||t,(function(o,a){v&&(o=t[a=o]),Kn(i,a,e(o,r,n,a,t,s))})),i};var Sa=function(e){return ka(e,5)};var ja=function(e){return y(e)&&"[object RegExp]"==h(e)},xa=fo&&fo.isRegExp,Aa=xa?uo(xa):ja;const Ia=(e,t,r,n)=>{if(A.dev){let o=n;n&&(o=Sa(n)),J(`%c${e}%c %c${r[0]}`,...(e=>[`background-color:${e};color:#fff;padding:0 0.3em`,"",`color:${e};text-decoration:underline`])(t),r[1]||"","\n=>",o)}},Ca=async(e,t,r)=>{try{for(let[n,o]of r){Array.isArray(n)||(n=[n]);let r=!1;for(let e of n)(v(e)&&e===t||Aa(e)&&e.test(t))&&(r=!0);if(r){Array.isArray(o)||(o=[o]);for(let t of o)v(t)||await t(e)}}}catch(e){J(e)}},Ra=[[[/^userSupportIdols\/\d+$/,/^userSupportIdols\/statusMax/,/^produceTeachingSupportIdols\/\d+$/],[nt,pt,async e=>{await sr(),e.supportIdol.produceSupportIdolEvents.forEach(e=>{ur(e,"title"),lr(e.id,e.title)})}]],[/^userProduce(Teaching)?SupportIdols\/\d+$/,[nt,async e=>{var t,r,n,o,a;await Xe(),it(e.skillPanels),null===(t=e.userProduceSupportIdolProduceExSkills)||void 0===t||t.forEach(e=>{st(e.produceExSkill)}),null===(r=e.userSupportIdol)||void 0===r||null===(n=r.supportIdol)||void 0===n||null===(o=n.supportIdolActiveSkill)||void 0===o||null===(a=o.activeSkills)||void 0===a||a.forEach(e=>{tt(e,"comment"),tt(e,"name")})}]],[/^userReserveSupportIdols\/userSupportIdol\/\d+$/,[nt,async e=>{var t,r,n;await Xe(),it(e.supportIdol.skillPanels),null===(t=e.supportIdol)||void 0===t||null===(r=t.supportIdolActiveSkill)||void 0===r||null===(n=r.activeSkills)||void 0===n||n.forEach(e=>{tt(e,"comment"),tt(e,"name")})}]],[/^userIdols\/\d+\/produceExSkillTop$/,yt],[/^userSupportIdols\/\d+\/produceExSkillTop$/,yt],[[/^userIdols\/\d+$/,/^userIdols\/statusMax$/,/^produceTeachingIdols\/\d+$/],[ft,async e=>{await sr(),e.idol.produceAfterEvents.forEach(e=>{ur(e,"title"),lr(e.id,e.title)}),e.idol.produceIdolEvents.forEach(e=>{ur(e,"title"),lr(e.id,e.title)})}]],[[/^userProduce(Teaching)?Idols\/\d+$/,"userProduceTeachingIdol"],async e=>{await Xe(),e.activeSkills.forEach(e=>{at(e)}),ct(e.userIdol.idol.memoryAppeals),e.userProduceIdolProduceExSkills.forEach(e=>{st(e.produceExSkill)})}],[/^userReserveIdols\/userIdol\/\d+$/,async e=>{await Xe(),it(e.idol.skillPanels),ct(e.idol.memoryAppeals)}],[/^userFesIdols\/\d+$/,ht],[["userProduces/skillPanels","userProduceTeachings/skillPanels"],vt],["userMissions",async e=>{var t;await Lt(),Ht(e.dailyUserMissions),Ht(e.weeklyUserMissions),null===(t=e.eventUserMissions)||void 0===t||t.forEach(e=>{Ht(null==e?void 0:e.userMissions)}),Ht(e.normalUserMissions),Ht(e.specialUserMissions)}],[/^fesRaidEvents\/\d+\/rewards$/,async e=>{await Lt(),Jt(e.fesRaidBestScoreRewards),Jt(e.fesRaidLapRewards),Jt(e.fesRaidPointRewards)}],[["characterAlbums","album/top"],async e=>{await sr(),dr(e.gameEvents),dr(e.specialEvents)}],[["userShops","userIdolPieceShops"],async e=>{await Mt(),e&&(Array.isArray(e.userShops)&&e.userShops.forEach(e=>{Pt(e)}),Array.isArray(e.userEventShops)&&e.userEventShops.forEach(e=>{Pt(e.userShop)}))}],[["userRecoveryItems","userProduceItems","userExchangeItems","userLotteryTickets","userEvolutionItems","userGashaTickets","userScoutTickets","userEnhancementItems"],$t],[[/^userPresents\?limit=/,/^userPresentHistories\?limit=/],async e=>{await Mt(),Array.isArray(e)&&e.forEach(e=>{Tt(e.content,"name"),Tt(e,"note")})}],[/gashaGroups\/\d+\/rates/,"cardName"],["userProduces",[Fr,zt,Kt]],[/^fes(Match)?Concert\/actions\/resume$/,[Lr,bt]],[/earthUsers\/[^\/]+\/userFesIdols\/\d+$/,mt],["userBeginnerMissions/top",Qt],["userRaidDecks",async e=>{await Xe(),e.userRaidDecks.forEach(e=>{e.userRaidDeckMembers.forEach(e=>{var t;null===(t=e.userFesIdol)||void 0===t||t.activeSkills.forEach(e=>{at(e)})})})}],["idolRoads/top",async e=>{var t;await Lt(),Wt(e.userMissions,!1),null===(t=e.userIdols)||void 0===t||t.forEach(Vt)}],[/^produces\/\d+\/decks$/,async e=>{var t;const r=await Ke();null===(t=e.userSupportIdols)||void 0===t||t.forEach(e=>{var t;rt(null===(t=e.supportIdol)||void 0===t?void 0:t.supportSkills,r)})}],["userProduceAbilities",_t],["userProduceAreas",async e=>{var t;await Xe(),null===(t=e.abilities)||void 0===t||t.forEach(e=>{tt(e,"acquireComment"),tt(e,"name"),tt(e,"comment")})}],[/^gashas\/\d+\/redraws$/,async e=>{const t=[];e.forEach(e=>{e.comment&&t.push(e.comment)}),await Pr(t)}],[/^missionEvents\/\d+\/top$/,[Yt,Dt]]],Ma=[["myPage",[async e=>{await Lt(),Ht(e.reportUserMissions)},async e=>{try{let t=[];e.userHomeDeck.userHomeDeckAnimationMember&&(t=[...e.userHomeDeck.userHomeDeckAnimationMember.mypageComments]);let r=e.userHomeDeck.userHomeAnimationDeck.userHomeAnimationDeckMembers;r&&r.forEach(e=>{e.mypageComments.forEach(e=>{t.push(e)}),e.mypageConversations.forEach(e=>{e.mypageConversationComments.forEach(e=>{t.push(e)})})}),e.userHomeDeck.userHomeDeckMembers.length&&e.userHomeDeck.userHomeDeckMembers.forEach(e=>{e.mypageComments.forEach(e=>{t.push(e)})}),await Pr(t)}catch(e){J(e)}},async e=>{await Lt();let t=e.beginnerMission;t&&(t.clearedLectureMission&&Wt([t.clearedLectureMission]),t.progressLectureMission&&Wt([t.progressLectureMission]))},async e=>{await zt(e.userProduce)},async e=>{var t;await sr(),ur(null==e||null===(t=e.userProduce)||void 0===t?void 0:t.produce,"title")}]],[/^characterAlbums\/characters\/\d+$/,[async e=>{await sr(),e.albumCommunicationTitles.forEach(e=>{ur(e,"title")}),e.communications.forEach(e=>{ur(e,"title"),lr(e.communicationId,e.title)}),e.voices.forEach(e=>{ur(e,"title"),ur(e,"releasedConditionComment")})},async e=>{if(e.voices){const t=[];e.voices.forEach(e=>{e.characterTrustLevelComment&&t.push(e.characterTrustLevelComment)}),await Pr(t)}}]],[/^(produceMarathons|fesMarathons|trainingEvents)\/\d+\/top$/,[Yt,Dt]],[/userIdols\/\d+\/produceExSkills\/\d+\/actions\/set/,ft],["userShops/actions/purchase",async e=>{await Mt(),Tt(null==e?void 0:e.shopMerchandise,"title"),Tt(null==e?void 0:e.shopMerchandise,"comment")}],[/produces\/\d+\/actions\/ready/,[$t,async e=>{const t=await Ke();e.userDecks.forEach(e=>{e.userSupportIdols.forEach(e=>{var r;rt(null===(r=e.supportIdol)||void 0===r?void 0:r.supportSkills,t)})})}]],[/userPresents\/\d+\/actions\/receive/,async e=>{await Mt(),Tt(e.receivedPresent,"Name")}],[/userMissions\/\d+\/actions\/receive/,async e=>{await Mt(),Tt(e.userMission.mission.missionReward.content,"name")}],["userLoginBonuses",async e=>{await Mt(),e.userLoginBonuses.forEach(e=>{e.loginBonus.sheets.forEach(e=>{e.rewards.forEach(e=>{Tt(e.content,"name")})})}),e.userTotalBonuses.forEach(e=>{e.rewards.forEach(e=>{Tt(e.content,"name")})})}],["fesTop",[async e=>{await Mt(),e.lastRankingResult&&Array.isArray(e.lastRankingResult.fesMatchGradeRewards)&&e.lastRankingResult.fesMatchGradeRewards.forEach(e=>{Tt(e.content,"name")})},async e=>{if(e.userFesDeck)try{let t=[],r=e.userFesDeck.userFesDeckMembers;for(let e of r)e.fesTopCharacterReactions.forEach(e=>{t.push(e)});await Pr(t)}catch(e){J(e)}}]],[[/^userProduce(Teaching)?s\/skillPanels\/\d+$/,/^userProduces\/limitedSkills\/\d+$/],vt],[/userSupportIdols\/\d+\/produceExSkills\/\d+\/actions\/set/,[pt,nt]],[/^produces\/actions\/(resume|next)$/,[Hr,async e=>{e.userProduceIdeaNotes&&(await Xe(),e.userProduceIdeaNotes.forEach(e=>{let t=e.produceIdeaNote.produceIdeaNoteCompleteBonus;tt(t,"title"),tt(t,"comment"),e.produceIdeaNote.produceIdeaNoteExtraBonuses.forEach(e=>{tt(e,"comment"),tt(e,"condition")})}))},Fr,Nr,Lr,Ur,Dr,async e=>{try{var t;await Pr(null===(t=e.produceReporterEvent)||void 0===t?void 0:t.produceReporterEventAnswers,"comment2")}catch(e){J(e)}},nt,Br]],[["produces/actions/resume","produces/actions/finish","produceTeachings/resume"],[async e=>{e.gameData||(await Xe(),lt(e))},bt,Hr]],["produces/actions/endWeek",Nr],["produces/actions/act",[async e=>{if(!e.lessonResult)return;let t=e.lessonResult;try{let e=[];t.produceActCutinComment&&(e=e.concat(t.produceActCutinComment)),t.produceRestBoostIdolComment&&(e=e.concat(t.produceRestBoostIdolComment)),t.produceRestBoostSupportIdolComment&&(e=e.concat(t.produceRestBoostSupportIdolComment)),t.produceRestComments&&(e=e.concat(t.produceRestComments)),await Pr(e)}catch(e){J(e)}},async e=>{var t,r,n;await Xe();let o=null===(t=e.lessonResult)||void 0===t||null===(r=t.userProduceIdeaNote)||void 0===r||null===(n=r.produceIdeaNote)||void 0===n?void 0:n.produceIdeaNoteCompleteBonus;at(o)},Hr]],[/^fes(Match|Raid)?Concert\/actions\/start$/,[zr,gt]],[/^fes(Match)?Concert\/actions\/resume$/,[Lr,bt]],["fesRaidConcert/actions/resume",[async e=>{if(e.gameState&&e.gameState.game_data)try{let t=JSON.parse(e.gameState.game_data);t.judges&&await zr(t),e.gameState.game_data=JSON.stringify(t)}catch(e){J(e)}},async e=>{if(e.gameState&&e.gameState.game_data)try{let t=JSON.parse(e.gameState.game_data);t.userRaidDeck&&await gt(t),e.gameState.game_data=JSON.stringify(t)}catch(e){J(e)}}]],["produces/actions/result",[async e=>{try{let t=e.characterTrustLevelUpComments;await Pr(t)}catch(e){J(e)}},async e=>{await Xe(),e.produceExSkillRewards.forEach(e=>{st(e.produceExSkill)})}]],[[/^produce(Teaching)?s\/(\d+\/audition|concert)\/actions\/start$/,/^produceTeachings\/(auditions|concerts)\/start$/],[wt]],[/^produces\/(\d+\/audition|concert)\/actions\/(start|finish)$/,[Dr,Ur,Br,async e=>{var t,r;await Xe(),null===(t=e.concertEvent)||void 0===t||null===(r=t.abilities)||void 0===r||r.forEach(e=>{tt(e,"name")})}]],["userProduceHelperSupportIdols",async e=>{try{e.characterComment,e.producerComment;await Tr([e],0,!0)}catch(e){J(e)}}],[["produceTeachings/resume","produceTeachings/next"],[Kt,nt]],[/^userSelectLoginBonuses\/\d+$/,async e=>{await Mt(),e.rewards.forEach(e=>{Tt(e.content,"name")})}],[/^userLectureMissions\/\d+\/actions\/receive$/,Qt],[/^produceMarathons\/\d+\/top$/,async e=>{await sr(),e.releasedCommunications.forEach(e=>{ur(e,"name"),ur(e,"title"),lr(e.id,`${e.name}-${e.title}`)}),ur(e.gameEvent,"name")}],["userProduceAbilities",_t],[/^characterAlbums\/characters\/\d+$/,async e=>{const t=[];e.produceIdols.forEach(e=>{e.comment&&t.push(e.comment)}),await Pr(t)}],[/^gashas\/\d+\/actions\/draw$/,async e=>{var t;const r=[];null===(t=e.gashaDraws)||void 0===t||t.forEach(e=>{e.comment&&r.push(e.comment)}),await Pr(r)}]],Oa=[[/^userSupportIdols\/\d+$/,nt],["userFesDecks",async e=>{await Xe(),e.userFesDecks.forEach(e=>{e.userFesDeckMembers.forEach(e=>{var t;null===(t=e.userFesIdol)||void 0===t||t.activeSkills.forEach(e=>{at(e)})})})}],[/^produces\/\d\/produceItem\/consume$/,async e=>{var t;await Mt();const r=null===(t=e.consumeProduceItem)||void 0===t?void 0:t.produceItem;r&&(Tt(r,"name"),Tt(r,"comment"))}]],Ta=[["userIdolRoads",async e=>{await Lt(),Vt(e.userIdol)}]];async function Pa(){const e=await he("REQUEST"),t=e.get;e.get=async function(...e){const r=e[0],n=await t.apply(this,e);if(!r)return n;let o=n.body;return Ia("GET","#009688",e,o),await Ca(o,r,Ra),n};const r=e.patch;e.patch=async function(...e){const t=e[0],n=await r.apply(this,e);if(!t)return n;let o=n.body;return Ia("PATCH","#8BC34A",e,o),await Ca(o,t,Oa),n};const n=e.post;e.post=async function(...e){const t=e[0],r=await n.apply(this,e);if(!t)return r;let o=r.body;return Ia("POST","#3F51B5",e,o),await Ca(o,t,Ma),r};const o=e.put;e.put=async function(...e){const t=e[0],r=await o.apply(this,e);if(!t)return r;let n=r.body;return Ia("PUT","#9C27B0",e,n),await Ca(n,t,Ta),r}}const $a=new Map;let Da=!1;let za=null;const Fa=async()=>(za||(za=(async()=>{if(!Da){let e=await oe("image");e||(e=await ee("/data/image.csv"),ae("image",e));re(e).forEach(e=>{if(null==e?void 0:e.name){const t=L(e.name),r=L(e.url),n=L(e.version)||"1";t&&r&&$a.set(t,{url:r,version:n})}}),Da=!0}return $a})()),await za);let Na=!1;async function La(){const e=await he("AOBA");if(Na)return;e.loaders.Resource.prototype=Object.assign({},e.loaders.Resource.prototype);const t=e.loaders.Resource.prototype._loadElement;e.loaders.Resource.prototype._loadElement=async function(e){A.dev;try{const t=await Fa();if("image"===e&&t.has(this.name)){const e=t.get(this.name);if(this.url.endsWith("v="+e.version)){const t="image/"+e.url;this.url=`${A.origin}/data/${t}?v=${A.hashes[t]}`,this.crossOrigin=!0}else J("%cimage version not match","color:#fc4175"),J(this.name,this.url)}}catch(e){}return t.call(this,e)},Na=!0}var Ua=function(){return o.Date.now()};var Ba=function(e){return"symbol"==typeof e||y(e)&&"[object Symbol]"==h(e)},Ha=/^\s+|\s+$/g,Ja=/^[-+]0x[0-9a-f]+$/i,Wa=/^0b[01]+$/i,qa=/^0o[0-7]+$/i,Ga=parseInt;var Ya=function(e){if("number"==typeof e)return e;if(Ba(e))return NaN;if(on(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=on(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Ha,"");var r=Wa.test(e);return r||qa.test(e)?Ga(e.slice(2),r?2:8):Ja.test(e)?NaN:+e},Ka=Math.max,Qa=Math.min;var Va=function(e,t,r){var n,o,a,s,i,c,l=0,u=!1,d=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var r=n,a=o;return n=o=void 0,l=t,s=e.apply(a,r)}function h(e){return l=e,i=setTimeout(y,t),u?p(e):s}function m(e){var r=e-c;return void 0===c||r>=t||r<0||d&&e-l>=a}function y(){var e=Ua();if(m(e))return v(e);i=setTimeout(y,function(e){var r=t-(e-c);return d?Qa(r,a-(e-l)):r}(e))}function v(e){return i=void 0,f&&n?p(e):(n=o=void 0,s)}function g(){var e=Ua(),r=m(e);if(n=arguments,o=this,c=e,r){if(void 0===i)return h(c);if(d)return clearTimeout(i),i=setTimeout(y,t),p(c)}return void 0===i&&(i=setTimeout(y,t)),s}return t=Ya(t)||0,on(r)&&(u=!!r.leading,a=(d="maxWait"in r)?Ka(Ya(r.maxWait)||0,t):a,f="trailing"in r?!!r.trailing:f),g.cancel=function(){void 0!==i&&clearTimeout(i),l=0,n=c=o=i=void 0},g.flush=function(){return void 0===i?s:v(Ua())},g};const Za=`\n  <style>\n  #sczh-story-tool {\n    position: absolute;\n    display: none;\n    background: #ffffff;\n    border-radius: 24px;\n    box-sizing: border-box;\n    font-family: sczh-yuanti;\n    align-items: center;\n    justify-content: center;\n    color: #ff6499;\n    text-shadow: 0 0 6px #fff;\n    cursor: pointer;\n    user-select: none;\n    width: 100px;\n    height: 100px;\n    font-size: 32px;\n    border: 7px solid transparent;\n    border-image: url(${A.origin}/data/image/border.png);\n    border-image-slice: 7;\n    transform-origin: top right;\n    transition: opacity 0.3s;\n  }\n  .story-tool-btns {\n    width: 100%;\n    height: 100%;\n    display: none;\n  }\n  .story-tool-btns .btn-download-sczh,\n  .story-tool-btns label {\n    flex: 1;\n    height: 100%;\n    background: #fff;\n    display: flex;\n    box-sizing: content-box;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    color: #c0aade;\n    text-shadow: 0 0 6px #fff;\n  }\n  .story-tool-btns .btn-download-sczh:hover {\n    color: #9f66ec;\n  }\n  .story-tool-btns label {\n    color: rgb(242, 156, 199);\n    border-right: 1px solid #c9c9c9;\n  }\n  #sczh-story-tool .btn-close-sczh {\n    height: 25px;\n    width: 50px;\n    background: rgba(0, 0, 0, 0.58);\n    color: #fff;\n    letter-spacing: 2px;\n    position: absolute;\n    right: -25px;\n    top: -20px;\n    border-radius: 4px;\n    display: none;\n    align-items: center;\n    justify-content: center;\n    z-index: 1;\n    font-family: sczh-heiti;\n    font-size: 15px;\n  }\n  #sczh-story-tool:hover {\n    width: 200px;\n  }\n  #sczh-story-tool:hover .story-tool-btns {\n    display: flex;\n  }\n  #sczh-story-tool:hover .btn-close-sczh {\n    display: flex;\n  }\n  #sczh-story-tool:hover > .text-sczh {\n    display: none;\n  }\n  #sczh-story-tool .btn-close-sczh:hover {\n    background: rgba(0, 0, 0, 0.9);\n  }\n  #sczh-story-tool.blur {\n    opacity: 0.2;\n  }\n  .story-tool-btns label:hover {\n    color: #f270b1;\n  }\n  .story-tool-btns .btn-download-sczh:hover,\n  .story-tool-btns label:hover {\n    background-color: #f7f7f7;\n  }\n  </style>\n  <div id="sczh-story-tool"><span class="text-sczh">커뮤</span>\n    <span id="btn-close-sczh" class="btn-close-sczh">닫기</span>\n    <input type="file" style="display:none" id="ipt-preview-sczh" multiple accept=".csv">\n    <div class="story-tool-btns">\n      <label for="ipt-preview-sczh">실험</label>\n      <div id="btn-download-sczh" class="btn-download-sczh">다운</div>\n    </div>\n  </div>\n  `;let Xa=!1;const es=e=>{if(Xa)return;Xa=!0,document.body.insertAdjacentHTML("beforeend",Za);const t=document.getElementById("sczh-story-tool"),r=Va(()=>{const r=[.017,.22],n=window.innerHeight,o=window.innerWidth;let a=n,s=o,i=0,c=0;n/o>9/16?(a=9*o/16,i=(n-a)/2):(s=16*n/9,c=(o-s)/2),t.style.right=Math.floor(c+r[0]*s)+"px",t.style.top=Math.floor(i+r[1]*a)+"px",t.style.transform=`scale(${(a/900).toFixed(3)})`,e.name?t.style.display="flex":t.style.display="none"},300);r(),window.addEventListener("resize",r);document.getElementById("btn-download-sczh").addEventListener("click",(function(){if(e.name){((e,t)=>{const r=document.createElement("a");r.download=t,r.style.display="none";const n=new Blob([e],{type:"text/csv"});r.href=URL.createObjectURL(n),document.body.appendChild(r),r.click(),document.body.removeChild(r)})(te.unparse(e.list),e.filename)}}));document.getElementById("btn-close-sczh").addEventListener("click",(function(){t.style.display="none",A.story="normal",P()}));let n;document.getElementById("ipt-preview-sczh").addEventListener("change",(function(){const t=this.files;t.length&&t.forEach(t=>{const r=new FileReader;r.onload=t=>{const r=t.target.result,n=Me(r);if(n.has("name")){const t=n.get("name");e.preview.set(t,n),(e=>{const t=[...e].slice(-5).map(e=>(e[1]=[...e[1]],e));sessionStorage.setItem("sczh:preview",JSON.stringify(t))})(e.preview),alert(`도입${t}성공`)}},r.readAsText(t)})})),t.addEventListener("mouseenter",()=>{clearTimeout(n),t.classList.remove("blur")});const o=()=>{clearTimeout(n),n=setTimeout(()=>{t.classList.add("blur")},5e3)};t.addEventListener("mouseleave",o),o()},ts={name:"",filename:"",list:"",preview:new Map};let rs=!1;const ns=async()=>{const e=await he("SCENARIO"),t=e.load;e.load=async function(...e){const r=await t.apply(this,e),n=e[0];if(!n)return r;if(A.dev&&n.includes("/assets/json/")&&Ia("STORY","#ad37c2",e,r),n.includes("/produce_events/")||n.includes("/produce_communications/")||n.includes("/produce_communications_promises/")||n.includes("/produce_communication_promise_results/")||n.includes("/support_skills/")||n.includes("/game_event_communications/")||n.includes("/special_communications/")||n.includes("/produce_communication_cheers/")||n.includes("/produce_communication_auditions/")||n.includes("/produce_communication_televisions/"))try{const e=n.replace(/^\/assets\/json\//,"");let t;if("edit"===A.story&&(((e,t)=>{const r=t.replace(".json",""),n=(e=>{var t;const r=e.match(/\/(\d+)$/);return null!==(t=null==r?void 0:r[1])&&void 0!==t?t:""})(r);let o=cr.get(n)||r.replace(/\//g,"_");o=o.replace("​","");const a=[];e.forEach(e=>{let t=L(W(e.text));(null==t?void 0:t.trim())?a.push({id:e.id||"0000000000000",name:e.speaker||"",text:t,trans:""}):e.select&&a.push({id:"select",name:"",text:L(W(e.select)),trans:""})}),a.push({id:"info",name:t,text:"",trans:""}),a.push({id:"번역자",name:"",text:"",trans:""}),ts.name=t,ts.filename=o+".csv",ts.list=a})(r,e),es(ts)),(()=>{if(rs)return;rs=!0;const e=sessionStorage.getItem("sczh:preview");if(e)try{const t=JSON.parse(e),r=new Map(t);for(let[e,t]of r)r.set(e,new Map(t));ts.preview=r}catch(e){J(e)}})(),t=ts.preview.has(e)?ts.preview.get(e):await(async e=>{if(!Re){let e=await oe("story.json");if(e)Re=new Map(JSON.parse(e));else{const e=await ee("/story.json");Re=new Map(e),ae("story.json",JSON.stringify(Re))}}if(Re.has(e)){if(Ae.has(e))return Ae.get(e);{const t=Re.get(e),r=await ee(`/data/story/${t}.csv`),n=Me(r);return Ae.set(e,n),n}}return!1})(e),t){const e=await Oe();((e,t,r,n)=>{if(!Array.isArray(e))return;const o=K();e.forEach(e=>{if(Y(e,n),e.text){const n=o(e.id),a=B(e.text);t.has(a)?e.text=t.get(a):n&&t.has(""+n)?e.text=t.get(""+n):r.has(a)&&(e.text=N(r.get(a)))}if(e.select){const n=B(e.select),o=n+"-select";t.has(o)?e.select=t.get(o):r.has(n)&&(e.select=N(r.get(e.select)))}})})(r,t,e,await Se())}else await Tr(r,0,!1)}catch(e){J(e)}return r}},os=e=>{const t=document.createElement("link");t.setAttribute("rel","preload"),t.setAttribute("href",e),t.setAttribute("as","font"),t.setAttribute("type","font/woff2"),t.setAttribute("crossorigin","anonymous"),document.head.appendChild(t)},as=(e,t)=>`/data/font/${e}.woff2?v=${t[`font/${e}.woff2`]}`,ss=async()=>{const e=document.createElement("style"),{hashes:t}=await X;e.innerHTML=`\n  @font-face {\n    font-family: "sczh-heiti";\n    src: url("${A.origin}${as("heiti",t)}");\n  }\n  @font-face {\n    font-family: "sczh-yuanti";\n    src: url("${A.origin}${as("heiti",t)}");\n  }\n  ::-webkit-scrollbar {\n    display: none;\n  }\n  `,"yuanti"===A.font1&&os(`${A.origin}${as("heiti",t)}`),"heiti"===A.font2&&os(`${A.origin}${as("heiti",t)}`),document.head.appendChild(e)};window.addEventListener("blur",(function(e){"on"===A.bgm&&e.stopImmediatePropagation()}),!1),document.addEventListener("visibilitychange",(function(e){"on"===A.bgm&&e.stopImmediatePropagation()}));let is=0;const cs=async()=>{var e;ce||is>=300?(async()=>{try{await Promise.all([La(),ss(),ye(),Be(),Pa(),ns()])}catch(e){J(e)}})():(await(e=100,new Promise(t=>{setTimeout(t,e)})),is++,is%10==0&&J(`Waiting: ${is/10}s`),await cs())};"loading"!=document.readyState?cs():window.unsafeWindow?window.unsafeWindow.addEventListener("DOMContentLoaded",cs):window.addEventListener("DOMContentLoaded",cs)}();
